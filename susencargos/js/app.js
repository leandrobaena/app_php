Ext.define('susencargos.model.Application',{extend:'Ext.data.Model',fields:[{name:'idapplication',type:'int'},{name:'name',type:'string'}]});Ext.define('susencargos.model.Group',{extend:'Ext.data.Model',fields:[{name:'idgroup',type:'int'},{name:'name',type:'string'},{name:'active',type:'boolean',defaultValue:false}]});Ext.define('susencargos.model.User',{extend:'Ext.data.Model',fields:[{name:'iduser',type:'int'},{name:'login',type:'string'},{name:'name',type:'string'},{name:'active',type:'boolean',defaultValue:false},{name:'email',type:'string'},{name:'lastLogin',type:'date',dateFormat:'Y-m-d H:i:s'},{name:'logged',type:'boolean',defaultValue:false}]});Ext.define('susencargos.model.Module',{extend:'Ext.data.Model',fields:[{name:'idmodule',type:'int',defaultValue:0},{name:'name',type:'string'},{name:'idparent',type:'int',allowNull:true},{name:'class',type:'string'},{name:'script',type:'string'},{name:'application',reference:'susencargos.model.Application'}],idProperty:'idmodule'});Ext.define('susencargos.model.Customer',{extend:'Ext.data.Model',fields:[{name:'idcustomer',type:'int'},{name:'name',type:'string'},{name:'taxid',type:'string'},{name:'address',type:'string'},{name:'phone',type:'string'},{name:'city',reference:'susencargos.model.City'},{name:'user',reference:'susencargos.model.User'},{name:'contact',type:'string'}]});Ext.define('susencargos.model.Zone',{extend:'Ext.data.Model',fields:[{name:'idzone',type:'int'},{name:'name',type:'string'}]});Ext.define('susencargos.model.City',{extend:'Ext.data.Model',fields:[{name:'idcity',type:'int'},{name:'name',type:'string'},{name:'zone',reference:'susencargos.model.Zone'}]});Ext.define('susencargos.model.StateTracking',{extend:'Ext.data.Model',fields:[{name:'idstatetracking',type:'int'},{name:'name',type:'string'}]});Ext.define('susencargos.model.Package',{extend:'Ext.data.Model',fields:[{name:'idpackage',type:'int'},{name:'date',type:'date',dateFormat:'Y-m-d'},{name:'citySource',reference:'susencargos.model.City'},{name:'cityDestination',reference:'susencargos.model.City'},{name:'customer',reference:'susencargos.model.Customer'},{name:'nameTo',type:'string'},{name:'addressTo',type:'string'},{name:'phoneTo',type:'string'},{name:'content',type:'string'},{name:'observations',type:'string'},{name:'weight',type:'float'},{name:'volumen',type:'float'},{name:'amount',type:'int'},{name:'declaredValue',type:'float'},{name:'shippingValue',type:'float'},{name:'managementValue',type:'float'},{name:'totalValue',type:'float'},{name:'reference',type:'string'},{name:'payType',reference:'susencargos.model.PayType'},{name:'pacakgeType',reference:'susencargos.model.PackageType'}]});Ext.define('susencargos.model.PayType',{extend:'Ext.data.Model',fields:[{name:'idpaytype',type:'int'},{name:'name',type:'string'}]});Ext.define('susencargos.model.PackageType',{extend:'Ext.data.Model',fields:[{name:'idpackagetype',type:'int'},{name:'name',type:'string'}]});Ext.define('susencargos.model.LevelAccess',{extend:'Ext.data.Model',fields:[{name:'idlevelaccess',type:'int'},{name:'name',type:'string'}]});Ext.define('susencargos.model.GroupModule',{extend:'Ext.data.Model',fields:[{name:'idgroupmodule',type:'int'},{name:'group',reference:'susencargos.model.Group'},{name:'module',reference:'susencargos.model.Module'},{name:'levelAccess',reference:'susencargos.model.LevelAccess'}]});Ext.define('susencargos.model.Tracking',{extend:'Ext.data.Model',fields:[{name:'idtracking',type:'int'},{name:'date',type:'date',dateFormat:'Y-m-d H:i:s'},{name:'package',reference:'susencargos.model.Package'},{name:'state',reference:'susencargos.model.StateTracking'}]});Ext.define('susencargos.model.AuxReceivePackage',{extend:'Ext.data.Model',fields:[{name:'tracking',type:'string'}],idProperty:'tracking'});Ext.define('susencargos.model.TemplateMail',{extend:'Ext.data.Model',fields:[{name:'idtemplatemail',type:'int'},{name:'name',type:'string'},{name:'html',type:'string'}]});Ext.define('susencargos.model.Receiver',{extend:'Ext.data.Model',fields:[{name:'idreceiver',type:'int',defaultValue:0},{name:'name',type:'string'},{name:'address',type:'string'},{name:'city',reference:'susencargos.model.City'},{name:'phone',type:'string'},{name:'customer',reference:'susencargos.model.Customer'}]});Ext.define("susencargos.store.MainStoreRemote",{extend:"Ext.data.Store",remoteSort:true,remoteFilter:true,object:"",proxy:{type:"ajax",url:"stores/list_objects.php",extraParams:{object:""},reader:{type:"json",root:"data",successProperty:"success"}},constructor:function(a){a=Ext.apply({proxy:{extraParams:{object:a.object}}},a);this.callParent([a])},listeners:{load:function(b,c,a,d){if(!a){Ext.MessageBox.show({title:"Error",msg:"Sesi\xf3n expirada",buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}}}});Ext.define("susencargos.store.MainStoreLocal",{extend:"Ext.data.Store",object:"",proxy:{type:"ajax",url:"stores/list_objects.php",extraParams:{object:""},reader:{type:"json",root:"data",successProperty:"success"}},constructor:function(a){a=Ext.apply({proxy:{extraParams:{object:a.object}}},a);this.callParent([a])},listeners:{load:function(b,c,a,d){if(!a){Ext.MessageBox.show({title:"Error",msg:"Sesi\xf3n expirada",buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}}}});Ext.Loader.setConfig({enabled:true});Ext.Loader.setPath('Ext.ux','./js/extjs/build/ux');Ext.apply(Ext.form.field.VTypes,{daterange:function(val,field){var date=field.parseDate(val);if(!date){return false}if(field.startDateField&&(!this.dateRangeMax||(date.getTime()!=this.dateRangeMax.getTime()))){var start=field.up('form').down('#'+field.startDateField);start.setMaxValue(date);start.validate();this.dateRangeMax=date}else if(field.endDateField&&(!this.dateRangeMin||(date.getTime()!=this.dateRangeMin.getTime()))){var end=field.up('form').down('#'+field.endDateField);end.setMinValue(date);end.validate();this.dateRangeMin=date}return true},daterangeText:'La fecha de inicio debe ser inferior a la fecha de fin',password:function(val,field){if(field.initialPassField){var pwd=field.up('form').down('#'+field.initialPassField);return(val==pwd.getValue())}return true},passwordText:'La contrase\xf1a y la confirmaci\xf3n no coinciden'});Ext.create('Ext.app.Controller',{control:{'menu menuitem[action=users]':{click:'users'},'menu menuitem[action=groups]':{click:'groups'},'menu menuitem[action=apps]':{click:'apps'},'menu menuitem[action=customers]':{click:'customers'},'menu menuitem[action=zones]':{click:'zones'},'menu menuitem[action=cities]':{click:'cities'},'menu menuitem[action=templates]':{click:'templates'},'menu menuitem[action=levelsAccess]':{click:'levelsAccess'},'menu menuitem[action=statesTracking]':{click:'statesTracking'},'menu menuitem[action=packageTypes]':{click:'packageTypes'},'menu menuitem[action=templatesMail]':{click:'templatesMail'},'menu menuitem[action=packages]':{click:'packages'},'menu menuitem[action=enterPackage]':{click:'enterPackage'},'menu menuitem[action=receivePackages]':{click:'receivePackages'},'menu menuitem[action=dispatchPackages]':{click:'dispatchPackages'},'menu menuitem[action=deliveryPackage]':{click:'deliveryPackage'},'menu menuitem[action=rptPackages]':{click:'rptPackages'},'menu menuitem[action=rptCustomers]':{click:'rptCustomers'},'menu menuitem[action=rptFlightManifest]':{click:'rptFlightManifest'},'menu menuitem[action=rptBilling]':{click:'rptBilling'},'menu menuitem[action=typesResource]':{click:'typesResource'},'menu menuitem[action=changePass]':{click:'changePass'},'menu menuitem[action=logout]':{click:'logout'}},users:function(){this.openGrid('listUsers')},groups:function(){this.openGrid('listGroups')},apps:function(){this.openGrid('listApplications')},customers:function(){this.openGrid('listCustomers')},zones:function(){this.openGrid('listZones')},cities:function(){this.openGrid('listCities')},templates:function(){this.openGrid('listTemplates')},statesTracking:function(){this.openGrid('listStatesTracking')},packageTypes:function(){this.openGrid('listPackageTypes')},templatesMail:function(){this.openGrid('listTemplatesMail')},packages:function(){this.openGrid('listPackages')},levelsAccess:function(){this.openGrid('listLevelsAccess')},enterPackage:function(){Ext.getStore('CityL').load({params:{start:0,limit:1000},callback:function(){Ext.getStore('CustomerL').load({params:{start:0,limit:1000},callback:function(){Ext.getStore('PayTypeL').load({callback:function(){Ext.getStore('PackageTypeL').load({callback:function(){var form=Ext.widget('formPackage').down('form');form.loadRecord(Ext.create('susencargos.model.Package'));form.getForm().findField('amount').setValue(1);form.getForm().findField('declaredValue').setValue(400000);form.getForm().findField('idpackagetype').setValue(1);form.getForm().findField('weight').setValue(30);form.getForm().findField('idpaytype').setValue(1);form.getForm().findField('date').setValue(Ext.Date.format(new Date(),"Y-m-d"))}})}})}})}})},receivePackages:function(){Ext.widget('formReceivePackage')},dispatchPackages:function(){Ext.widget('formDispatchPackage')},deliveryPackage:function(){Ext.widget('formDeliveryPackage')},rptPackages:function(){Ext.Ajax.request({url:'stores/reports.php',params:{object:'packages'},success:function(response){var d=Ext.JSON.decode(response.responseText);Ext.MessageBox.show({title:'Reporte generado',msg:'El reporte fue generado con éxito haga clic en el botón para descargarlo',buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){window.open(d.msg.body)}})},failed:function(t,p,o){Ext.MessageBox.show({title:p.response.result.msg.title,msg:p.response.result.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}})},rptCustomers:function(){Ext.Ajax.request({url:'stores/reports.php',params:{object:'customers'},success:function(response){var d=Ext.JSON.decode(response.responseText);Ext.MessageBox.show({title:'Reporte generado',msg:'El reporte fue generado con éxito haga clic en el botón para descargarlo',buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){window.open(d.msg.body)}})},failed:function(t,p,o){Ext.MessageBox.show({title:p.response.result.msg.title,msg:p.response.result.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}})},rptFlightManifest:function(){Ext.widget('formFlightManifest')},rptBilling:function(){Ext.getStore('CustomerL').load({start:0,limit:10000,callback:function(s,r,ok,op,opt){Ext.getStore('CustomerL').removeAt(0);Ext.widget('formBilling')}})},changePass:function(){Ext.create('Ext.window.Window',{title:'Cambiar contrase\xf1a',iconCls:'edit',alias:'widget.formChangePass',width:300,modal:true,layout:'fit',autoShow:true,items:[{xtype:'form',url:'update/user_pass.php',defaults:{labelAlign:'right'},frame:true,items:[{xtype:'hiddenfield',name:'iduser',value:0},{xtype:'textfield',name:'pass',itemId:'pass',vtype:"alphanum",value:'',allowBlank:false,inputType:'password',anchor:'90%',fieldLabel:'* Contrase\xf1a'},{xtype:'textfield',name:'confirm',value:'',allowBlank:false,vtype:'password',initialPassField:'pass',inputType:'password',anchor:'90%',fieldLabel:'* Confirmaci\xf3n'}],buttons:[{text:'Guardar',handler:function(bu,ev){if(bu.up('form').getForm().isValid()){bu.up('form').getForm().submit({waitMsg:'Guardando ...',success:function(t,p,o){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO});bu.up('window').close()},failure:function(t,p){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});bu.up('window').close()}})}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}}},{text:'Cancelar',handler:function(bu,ev){bu.up('window').close()}}],bbar:['* Campos obligatorios']}]})},logout:function(){window.location='logout.php'},openGrid:function(grid){var opened=false;var content=Ext.getCmp('contenido');var panel=null;Ext.each(content.items.items,function(n,i,s){if(n.alias=='widget.'+grid){opened=true;panel=n}});if(!opened){panel=Ext.widget(grid);content.add(panel)}Ext.getCmp('contenido').setActiveTab(panel)}});Ext.create('Ext.app.Controller',{control:{'listApplications button[action=insert]':{click:'insert'},'listApplications button[action=clean]':{click:'cleanFilters'},'listApplications':{itemdblclick:'editDbl'},'listApplications actioncolumn[action=groups]':{click:'groups'},'listApplications actioncolumn[action=modules]':{click:'modules'},'listApplications actioncolumn[action=edit]':{click:'edit'},'listApplications actioncolumn[action=remove]':{click:'remove'},'formApplication button[action=cancel]':{click:'cancel'},'formApplication button[action=save]':{click:'save'},'listGroupsApplication grid#gridDestination dataview':{drop:'insertGroup'},'listGroupsApplication grid#gridSource dataview':{drop:'removeGroup'},'listModules button[action=insert]':{click:'insertModule'},'listModules button[action=clean]':{click:'cleanFiltersModules'},'listModules':{itemdblclick:'editDblModule'},'listModules actioncolumn[action=groups]':{click:'groupsModule'},'listModules actioncolumn[action=edit]':{click:'editModule'},'listModules actioncolumn[action=remove]':{click:'removeModule'},'formModule button[action=cancel]':{click:'cancel'},'formModule button[action=save]':{click:'saveModule'},'listGroupsModule button[action=insert]':{click:'insertGroupModule'},'listGroupsModule button[action=clean]':{click:'cleanFiltersGroupsModule'},'listGroupsModule':{itemdblclick:'editDblGroupModule'},'listGroupsModule actioncolumn[action=edit]':{click:'editGroupModule'},'listGroupsModule actioncolumn[action=remove]':{click:'removeGroupModule'},'formGroupModule button[action=cancel]':{click:'cancel'},'formGroupModule button[action=save]':{click:'saveGroupModule'}},groups:function(v,r,c,i,e){Ext.getStore('GroupsApplication').getProxy().setExtraParam('idapplication',v.getStore().getAt(c).get('idapplication'));Ext.getStore('GroupsApplication').load();Ext.getStore('NoGroupsApplication').getProxy().setExtraParam('idapplication',v.getStore().getAt(c).get('idapplication'));Ext.getStore('NoGroupsApplication').load();panel=Ext.widget('listGroupsApplication');panel.setTitle('Listado grupos asignados a la aplicaci\xf3n '+v.getStore().getAt(c).get('name'))},modules:function(v,r,c,i,e){Ext.getStore('Module').getProxy().setExtraParam('idapplication',v.getStore().getAt(c).get('idapplication'));Ext.getStore('Module').load();Ext.getStore('ModuleL').getProxy().setExtraParam('idapplication',v.getStore().getAt(c).get('idapplication'));Ext.getStore('ModuleTree').getProxy().setExtraParam('idapplication',v.getStore().getAt(c).get('idapplication'));Ext.getStore('ModuleTree').load();var opened=false;var content=Ext.getCmp('contenido');var panel=null;Ext.each(content.items.items,function(n,i,s){if(n.alias=='widget.listModules'){opened=true;panel=n}});if(!opened){panel=Ext.widget('listModules');content.add(panel)}panel.setTitle('Listado m\xf3dulos de la aplicaci\xf3n '+v.getStore().getAt(c).get('name'));Ext.getCmp('contenido').setActiveTab(panel)},cleanFilters:function(b,e){b.up('grid').filters.clearFilters()},insert:function(b,e){Ext.widget('formApplication').down('form').loadRecord(Ext.create('susencargos.model.Application'))},cancel:function(b,e){b.up('window').close()},edit:function(v,r,c,i,e){Ext.widget('formApplication').down('form').loadRecord(v.getStore().getAt(c))},editDbl:function(g,r){Ext.widget('formApplication').down('form').loadRecord(r)},save:function(b,e){if(b.up('form').getForm().isValid()){b.up('form').getForm().findField('id').setValue(b.up('form').getForm().findField('idapplication').getValue());b.up('form').getForm().submit({waitMsg:'Guardando ...',success:function(t,p,o){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('Application').load()}});b.up('window').close()},failure:function(t,p){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});b.up('window').close()}})}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}},remove:function(v,r,c,i,e){Ext.MessageBox.confirm('Eliminar registro','¿Desea eliminar el registro?',function(o){if(o=='yes'){Ext.Ajax.request({url:'delete/delete_object.php',params:{id:v.getStore().getAt(c).get('idapplication'),object:'apps'},success:function(response){var d=Ext.JSON.decode(response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('Application').load()}})},failed:function(t,p,o){Ext.MessageBox.show({title:p.response.result.msg.title,msg:p.response.result.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}})}})},insertGroup:function(n,d,dr,dp){Ext.each(d.records,function(n,i,s){Ext.Ajax.request({url:'update/save_object.php',params:{idapplication:Ext.getStore('GroupsApplication').getProxy().extraParams.idapplication,object:'groupApplication',id:0,idgroup:n.get('idgroup')},success:function(t,p,o){var d=Ext.JSON.decode(t.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})},failure:function(t,p,o){var d=Ext.JSON.decode(t.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}})})},removeGroup:function(no,d,dr,dp){Ext.each(d.records,function(n,i,s){Ext.Ajax.request({url:'delete/delete_object.php',params:{idapplication:Ext.getStore('GroupsApplication').getProxy().extraParams.idapplication,object:'groupApplication',idgroup:n.get('idgroup')},success:function(t,p,o){var d=Ext.JSON.decode(t.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})},failure:function(t,p,o){var d=Ext.JSON.decode(t.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}})})},insertModule:function(b,e){Ext.getStore('ModuleL').load();var form=Ext.widget('formModule');form.down('form').loadRecord(Ext.create('susencargos.model.Module'));form.down('form').getForm().findField('idapplication').setValue(Ext.getStore('Module').getProxy().extraParams.idapplication)},cleanFiltersModules:function(b,e){b.up('treepanel').filters.clearFilters()},editDblModule:function(g,r){var form=Ext.widget('formModule');form.down('form').getForm().loadRecord(r);form.down('form').getForm().findField('idapplication').setValue(Ext.getStore('Module').getProxy().extraParams.idapplication)},editModule:function(v,r,c,i,e){var form=Ext.widget('formModule');form.down('form').getForm().loadRecord(v.getStore().getAt(c));form.down('form').getForm().findField('idapplication').setValue(Ext.getStore('Module').getProxy().extraParams.idapplication)},saveModule:function(b,e){if(b.up('form').getForm().isValid()){b.up('form').getForm().findField('id').setValue(Ext.isNumeric(b.up('form').getForm().findField('idmodule').getValue())?b.up('form').getForm().findField('idmodule').getValue():0);b.up('form').getForm().submit({waitMsg:'Guardando ...',success:function(t,p,o){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('Module').load();Ext.getStore('ModuleTree').load()}});b.up('window').close()},failure:function(t,p){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});b.up('window').close()}})}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}},removeModule:function(v,c,dr,dp){Ext.MessageBox.confirm('Eliminar registro','¿Desea eliminar el registro?',function(o){if(o=='yes'){Ext.Ajax.request({url:'delete/delete_object.php',params:{id:v.getSelectionModel().getLastSelected().get('idmodule'),object:'modules'},success:function(response){var d=Ext.JSON.decode(response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('Module').load();Ext.getStore('ModuleTree').load()}})},failed:function(t,p,o){Ext.MessageBox.show({title:p.response.result.msg.title,msg:p.response.result.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}})}})},groupsModule:function(v,r,c,i,e){Ext.getStore('GroupsModule').getProxy().setExtraParam('idmodule',v.getStore().getAt(c).get('idmodule'));Ext.getStore('GroupsModule').load();var opened=false;var content=Ext.getCmp('contenido');var panel=null;Ext.each(content.items.items,function(n,i,s){if(n.alias=='widget.listGroupsModule'){opened=true;panel=n}});if(!opened){panel=Ext.widget('listGroupsModule');content.add(panel)}panel.setTitle('Listado grupos asignados al m\xf3dulo '+v.getStore().getAt(c).get('name'));Ext.getCmp('contenido').setActiveTab(panel)},insertGroupModule:function(b,e){Ext.getStore('GroupL').load({callback:function(){Ext.getStore('LevelAccessL').load({callback:function(){var form=Ext.widget('formGroupModule');form.down('form').loadRecord(Ext.create('susencargos.model.GroupModule'));form.down('form').getForm().findField('idmodule').setValue(Ext.getStore('GroupsModule').getProxy().extraParams.idmodule)}})}})},cleanFiltersGroupsModule:function(b,e){b.up('treepanel').filters.clearFilters()},saveGroupModule:function(b,e){if(b.up('form').getForm().isValid()){b.up('form').getForm().findField('id').setValue(b.up('form').getForm().findField('idgroupmodule').getValue());b.up('form').getForm().submit({waitMsg:'Guardando ...',success:function(t,p,o){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('GroupsModule').load()}});b.up('window').close()},failure:function(t,p){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});b.up('window').close()}})}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}},editDblGroupModule:function(g,r){Ext.getStore('GroupL').load({callback:function(){Ext.getStore('LevelAccessL').load({callback:function(){var form=Ext.widget('formGroupModule');form.down('form').getForm().loadRecord(r);form.down('form').getForm().findField('idmodule').setValue(Ext.getStore('GroupsModule').getProxy().extraParams.idmodule);form.down('form').getForm().findField('idgroup').setValue(r.get('group').idgroup);form.down('form').getForm().findField('idlevelaccess').setValue(r.get('levelAccess').idlevelaccess)}})}})},editGroupModule:function(v,r,c,i,e){Ext.getStore('GroupL').load({callback:function(){Ext.getStore('LevelAccessL').load({callback:function(){var form=Ext.widget('formGroupModule');form.down('form').getForm().loadRecord(v.getStore().getAt(c));form.down('form').getForm().findField('idmodule').setValue(Ext.getStore('GroupsModule').getProxy().extraParams.idmodule);form.down('form').getForm().findField('idgroup').setValue(v.getStore().getAt(c).get('group').idgroup);form.down('form').getForm().findField('idlevelaccess').setValue(v.getStore().getAt(c).get('levelAccess').idlevelaccess)}})}})},removeGroupModule:function(v,r,c,i,e){Ext.MessageBox.confirm('Eliminar registro','¿Desea eliminar el registro?',function(o){if(o=='yes'){Ext.Ajax.request({url:'delete/delete_object.php',params:{id:v.getStore().getAt(c).get('idgroupmodule'),object:'groupsModule'},success:function(response){var d=Ext.JSON.decode(response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('GroupsModule').load()}})},failed:function(t,p,o){Ext.MessageBox.show({title:p.response.result.msg.title,msg:p.response.result.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}})}})}});Ext.create('Ext.app.Controller',{control:{'listGroups button[action=insert]':{click:'insert'},'listGroups button[action=clean]':{click:'cleanFilters'},'listGroups':{itemdblclick:'editDbl'},'listGroups actioncolumn[action=countries]':{click:'countries'},'listGroups actioncolumn[action=applications]':{click:'applications'},'listGroups actioncolumn[action=users]':{click:'users'},'listGroups actioncolumn[action=edit]':{click:'edit'},'listGroups actioncolumn[action=remove]':{click:'remove'},'formGroup button[action=cancel]':{click:'cancel'},'formGroup button[action=save]':{click:'save'},'listUsersGroup grid#gridDestination dataview':{drop:'insertUser'},'listUsersGroup grid#gridSource dataview':{drop:'removeUser'},'listApplicationsGroup grid#gridDestination dataview':{drop:'insertApplication'},'listApplicationsGroup grid#gridSource dataview':{drop:'removeApplication'}},applications:function(v,r,c,i,e){Ext.getStore('ApplicationsGroup').getProxy().setExtraParam('idgroup',v.getStore().getAt(c).get('idgroup'));Ext.getStore('ApplicationsGroup').load();Ext.getStore('NoApplicationsGroup').getProxy().setExtraParam('idgroup',v.getStore().getAt(c).get('idgroup'));Ext.getStore('NoApplicationsGroup').load();panel=Ext.widget('listApplicationsGroup');panel.setTitle('Listado aplicaciones asignadas al grupo '+v.getStore().getAt(c).get('name'))},users:function(v,r,c,i,e){Ext.getStore('UsersGroup').getProxy().setExtraParam('idgroup',v.getStore().getAt(c).get('idgroup'));Ext.getStore('UsersGroup').load();Ext.getStore('NoUsersGroup').getProxy().setExtraParam('idgroup',v.getStore().getAt(c).get('idgroup'));Ext.getStore('NoUsersGroup').load();panel=Ext.widget('listUsersGroup');panel.setTitle('Listado usuarios asignados al grupo '+v.getStore().getAt(c).get('name'))},insert:function(b,e){Ext.widget('formGroup').down('form').loadRecord(Ext.create('susencargos.model.Group'))},cleanFilters:function(b,e){Ext.getStore('Group').load()},cancel:function(b,e){b.up('window').close()},edit:function(v,r,c,i,e){Ext.widget('formGroup').down('form').loadRecord(v.getStore().getAt(c))},editDbl:function(g,r){Ext.widget('formGroup').down('form').loadRecord(r)},save:function(b,e){if(b.up('form').getForm().isValid()){b.up('form').getForm().findField('id').setValue(b.up('form').getForm().findField('idgroup').getValue());b.up('form').getForm().submit({waitMsg:'Guardando ...',success:function(t,p,o){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('Group').load()}});b.up('window').close()},failure:function(t,p){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});b.up('window').close()}})}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}},remove:function(v,r,c,i,e){Ext.MessageBox.confirm('Eliminar registro','¿Desea eliminar el registro?',function(o){if(o=='yes'){Ext.Ajax.request({url:'delete/delete_object.php',params:{id:v.getStore().getAt(c).get('idgroup'),object:'groups'},success:function(t){var d=Ext.JSON.decode(t.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('Group').load()}})},failed:function(t,p,o){var d=Ext.JSON.decode(t.responseText);Ext.MessageBox.show({title:p.response.result.msg.title,msg:p.response.result.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}})}})},insertUser:function(n,d,dr,dp){Ext.each(d.records,function(n,i,s){Ext.Ajax.request({url:'update/save_object.php',params:{idgroup:Ext.getStore('UsersGroup').getProxy().extraParams.idgroup,id:0,object:'userGroup',iduser:n.get('iduser')},success:function(t,p,o){var d=Ext.JSON.decode(t.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})},failure:function(t,p,o){var d=Ext.JSON.decode(t.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}})})},removeUser:function(no,d,dr,dp){Ext.each(d.records,function(n,i,s){Ext.Ajax.request({url:'delete/delete_object.php',params:{idgroup:Ext.getStore('UsersGroup').getProxy().extraParams.idgroup,object:'userGroup',iduser:n.get('iduser')},success:function(t,p,o){var d=Ext.JSON.decode(t.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})},failure:function(t,p,o){var d=Ext.JSON.decode(t.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}})})},insertApplication:function(n,d,dr,dp){Ext.each(d.records,function(n,i,s){Ext.Ajax.request({url:'update/save_object.php',params:{idgroup:Ext.getStore('ApplicationsGroup').getProxy().extraParams.idgroup,object:'applicationGroup',id:0,idapplication:n.get('idapplication')},success:function(t,p,o){var d=Ext.JSON.decode(t.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})},failure:function(t,p,o){var d=Ext.JSON.decode(t.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}})})},removeApplication:function(no,d,dr,dp){Ext.each(d.records,function(n,i,s){Ext.Ajax.request({url:'delete/delete_object.php',params:{idgroup:Ext.getStore('ApplicationsGroup').getProxy().extraParams.idgroup,object:'applicationGroup',idapplication:n.get('idapplication')},success:function(t,p,o){var d=Ext.JSON.decode(t.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})},failure:function(t,p,o){var d=Ext.JSON.decode(t.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}})})}});Ext.create('Ext.app.Controller',{control:{'listStatesTracking button[action=insert]':{click:'insert'},'listStatesTracking button[action=clean]':{click:'cleanFilters'},'listStatesTracking':{itemdblclick:'editDbl'},'listStatesTracking actioncolumn[action=edit]':{click:'edit'},'listStatesTracking actioncolumn[action=remove]':{click:'remove'},'formStateTracking button[action=cancel]':{click:'cancel'},'formStateTracking button[action=save]':{click:'save'}},insert:function(b,e){Ext.widget('formStateTracking').down('form').loadRecord(Ext.create('susencargos.model.StateTracking'))},cleanFilters:function(b,e){b.up('grid').filters.clearFilters()},cancel:function(b,e){b.up('window').close()},edit:function(v,r,c,i,e){var form=Ext.widget('formStateTracking');form.down('form').loadRecord(v.getStore().getAt(c))},editDbl:function(g,r){var form=Ext.widget('formStateTracking');form.down('form').loadRecord(r)},save:function(b,e){if(b.up('form').getForm().isValid()){b.up('form').getForm().findField('id').setValue(b.up('form').getForm().findField('idstatetracking').getValue());b.up('form').getForm().submit({waitMsg:'Guardando ...',success:function(t,p,o){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('StateTracking').load()}});b.up('window').close()},failure:function(t,p){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});b.up('window').close()}})}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}},remove:function(v,r,c,i,e){Ext.MessageBox.confirm('Eliminar registro','¿Desea eliminar el registro?',function(o){if(o=='yes'){Ext.Ajax.request({url:'delete/delete_object.php',params:{id:v.getStore().getAt(c).get('idstatetracking'),object:'statesTracking'},success:function(response){var d=Ext.JSON.decode(response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('StateTracking').load()}})},failed:function(t,p,o){Ext.MessageBox.show({title:p.response.result.msg.title,msg:p.response.result.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}})}})}});Ext.create('Ext.app.Controller',{control:{'listTemplatesMail button[action=insert]':{click:'insert'},'listTemplatesMail button[action=clean]':{click:'cleanFilters'},'listTemplatesMail':{itemdblclick:'editDbl'},'listTemplatesMail actioncolumn[action=edit]':{click:'edit'},'listTemplatesMail actioncolumn[action=remove]':{click:'remove'},'formTemplateMail button[action=cancel]':{click:'cancel'},'formTemplateMail button[action=save]':{click:'save'}},insert:function(b,e){Ext.widget('formTemplateMail').down('form').loadRecord(Ext.create('susencargos.model.TemplateMail'))},cleanFilters:function(b,e){b.up('grid').filters.clearFilters();Ext.getStore('TemplateMail').load()},cancel:function(b,e){b.up('window').close()},edit:function(v,r,c,i,e){Ext.widget('formTemplateMail').down('form').loadRecord(v.getStore().getAt(c))},editDbl:function(g,r){Ext.widget('formTemplateMail').down('form').loadRecord(r)},save:function(b,e){if(b.up('form').getForm().isValid()){b.up('form').getForm().findField('id').setValue(b.up('form').getForm().findField('idtemplatemail').getValue());b.up('form').getForm().submit({waitMsg:'Guardando ...',success:function(t,p,o){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('TemplateMail').load()}});b.up('window').close()},failure:function(t,p){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});b.up('window').close()}})}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}},remove:function(v,r,c,i,e){Ext.MessageBox.confirm('Eliminar registro','¿Desea eliminar el registro?',function(o){if(o=='yes'){Ext.Ajax.request({url:'delete/delete_object.php',params:{id:v.getStore().getAt(c).get('idtemplatemail'),object:'templatesMail'},success:function(response){var d=Ext.JSON.decode(response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('TemplateMail').load()}})},failed:function(t,p,o){Ext.MessageBox.show({title:p.response.result.msg.title,msg:p.response.result.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}})}})}});Ext.create("Ext.app.Controller",{control:{"listUsers button[action=insert]":{click:'insert'},"listUsers button[action=clean]":{click:'cleanFilters'},"listUsers":{itemdblclick:'editDbl'},"listUsers actioncolumn[action=group]":{click:'group'},"listUsers actioncolumn[action=printer]":{click:'printer'},"listUsers actioncolumn[action=edit]":{click:'edit'},"listUsers actioncolumn[action=remove]":{click:'remove'},"formUser button[action=cancel]":{click:'cancel'},"formUser button[action=save]":{click:'save'},"formUser button[action=changePass]":{click:'changePass'},"listGroupsUser grid#gridDestination dataview":{drop:'insertGroup'},"listGroupsUser grid#gridSource dataview":{drop:'removeGroup'}},group:function(b,f,h,d,g){Ext.getStore("GroupsUser").getProxy().setExtraParam("iduser",b.getStore().getAt(h).get("iduser"));Ext.getStore("GroupsUser").load();Ext.getStore("NoGroupsUser").getProxy().setExtraParam("iduser",b.getStore().getAt(h).get("iduser"));Ext.getStore("NoGroupsUser").load();var a=Ext.widget("listGroupsUser");a.setTitle("Listado grupos del usuario "+b.getStore().getAt(h).get("name"))},insert:function(a,c){Ext.widget("formUser").down("form").loadRecord(Ext.create("susencargos.model.User"))},cleanFilters:function(a,c){a.up("grid").filters.clearFilters()},cancel:function(a,c){a.up("window").close()},edit:function(a,d,g,b,f){Ext.widget("formUser").down("form").loadRecord(a.getStore().getAt(g))},editDbl:function(b,a){Ext.widget("formUser").down("form").loadRecord(a)},save:function(a,c){if(a.up("form").getForm().isValid()){a.up("form").getForm().findField("id").setValue(a.up("form").getForm().findField("iduser").getValue());a.up("form").getForm().submit({waitMsg:"Guardando ...",success:function(b,e,g){var f=Ext.JSON.decode(e.response.responseText);Ext.MessageBox.show({title:f.msg.title,msg:f.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore("User").load()}});a.up("window").close()},failure:function(b,e){var f=Ext.JSON.decode(e.response.responseText);Ext.MessageBox.show({title:f.msg.title,msg:f.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});a.up("window").close()}})}else{Ext.MessageBox.show({title:"Error",msg:"Ingrese los datos correctos",buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}},remove:function(a,d,g,b,f){Ext.MessageBox.confirm("Eliminar registro","¿Desea eliminar el registro?",function(c){if(c=="yes"){Ext.Ajax.request({url:"delete/delete_object.php",params:{id:a.getStore().getAt(g).get("iduser"),object:"users"},success:function(e){var h=Ext.JSON.decode(e.responseText);Ext.MessageBox.show({title:h.msg.title,msg:h.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore("User").load()}})},failed:function(e){var p=Ext.JSON.decode(e.responseText);Ext.MessageBox.show({title:p.response.result.msg.title,msg:p.response.result.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}})}})},changePass:function(a,c){Ext.create("Ext.window.Window",{title:"Cambiar contrase\xf1a",iconCls:"edit",alias:"widget.formChangePass",width:300,modal:true,layout:"fit",autoShow:true,items:[{xtype:"form",url:"update/user_pass.php",defaults:{labelAlign:"right"},frame:true,items:[{xtype:'panel',html:'* Campos obligatorios',border:0,padding:10},{xtype:"hiddenfield",name:"iduser",value:a.up("form").getForm().findField("iduser").getValue()},{xtype:"textfield",name:"pass",itemId:"pass",vtype:"alphanum",value:"",allowBlank:false,inputType:"password",anchor:"90%",fieldLabel:"* Contrase\xf1a"},{xtype:"textfield",name:"confirm",value:"",allowBlank:false,vtype:"password",initialPassField:"pass",inputType:"password",anchor:"90%",fieldLabel:"* Confirmaci\xf3n"}]}],buttons:[{text:"Guardar",handler:function(b,d){if(b.up('window').down("form").getForm().isValid()){b.up('window').down("form").getForm().submit({waitMsg:"Guardando ...",success:function(e,f,h){var g=Ext.JSON.decode(f.response.responseText);Ext.MessageBox.show({title:g.msg.title,msg:g.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO});b.up("window").close()},failure:function(e,f){var g=Ext.JSON.decode(f.response.responseText);Ext.MessageBox.show({title:g.msg.title,msg:g.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});b.up("window").close()}})}else{Ext.MessageBox.show({title:"Error",msg:"Ingrese los datos correctos",buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}}},{text:"Cancelar",handler:function(b,d){b.up("window").close()}}]})},insertGroup:function(e,b,a,c){Ext.each(b.records,function(g,d,f){Ext.Ajax.request({url:"update/save_object.php",params:{iduser:Ext.getStore("GroupsUser").getProxy().extraParams.iduser,object:"groupUser",idgroup:g.get("idgroup"),id:0},success:function(h,i,k){var j=Ext.JSON.decode(h.responseText);Ext.MessageBox.show({title:j.msg.title,msg:j.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})},failure:function(h,i,k){var j=Ext.JSON.decode(h.responseText);Ext.MessageBox.show({title:j.msg.title,msg:j.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}})})},removeGroup:function(c,b,a,e){Ext.each(b.records,function(g,d,f){Ext.Ajax.request({url:"delete/delete_object.php",params:{iduser:Ext.getStore("GroupsUser").getProxy().extraParams.iduser,object:"groupUser",idgroup:g.get("idgroup")},success:function(h,i,k){var j=Ext.JSON.decode(h.responseText);Ext.MessageBox.show({title:j.msg.title,msg:j.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})},failure:function(h,i,k){var j=Ext.JSON.decode(h.responseText);Ext.MessageBox.show({title:j.msg.title,msg:j.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}})})},recoveryPass:function(a,c){if(a.up("form").getForm().isValid()){a.up("form").getForm().submit({waitMsg:"Procesando ...",success:function(b,e,g){var f=Ext.JSON.decode(e.response.responseText);Ext.MessageBox.show({title:f.msg.title,msg:f.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){if(a.up("form").getForm().findField("idrecoverymethod").getValue()==1){window.location="change_pass.php?"+f.link}}})},failure:function(b,e){var f=Ext.JSON.decode(e.response.responseText);Ext.MessageBox.show({title:f.msg.title,msg:f.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}})}else{Ext.MessageBox.show({title:"Error",msg:"Ingrese los datos correctos",buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}},setNewPass:function(a,c){if(a.up("form").getForm().isValid()){a.up("form").getForm().submit({waitMsg:"Guardando ...",success:function(b,e,g){var f=Ext.JSON.decode(e.response.responseText);Ext.MessageBox.show({title:f.msg.title,msg:f.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){window.location="cover.php"}})},failure:function(b,e){var f=Ext.JSON.decode(e.response.responseText);Ext.MessageBox.show({title:f.msg.title,msg:f.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}})}else{Ext.MessageBox.show({title:"Error",msg:"Ingrese los datos correctos",buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}}});Ext.create('Ext.app.Controller',{control:{'listCustomers button[action=insert]':{click:'insert'},'listCustomers button[action=clean]':{click:'cleanFilters'},'listCustomers':{itemdblclick:'editDbl'},'listCustomers actioncolumn[action=edit]':{click:'edit'},'listCustomers actioncolumn[action=receivers]':{click:'receivers'},'listCustomers actioncolumn[action=remove]':{click:'remove'},'formCustomer button[action=changePass]':{click:'changePass'},'formCustomer button[action=cancel]':{click:'cancel'},'formCustomer button[action=save]':{click:'save'},'listReceivers button[action=insert]':{click:'insertReceiver'},'listReceivers button[action=clean]':{click:'cleanFiltersReceivers'},'listReceivers':{itemdblclick:'editDblReceiver'},'listReceivers actioncolumn[action=edit]':{click:'editReceiver'},'listReceivers actioncolumn[action=remove]':{click:'removeReceiver'},'formReceiver button[action=cancel]':{click:'cancel'},'formReceiver button[action=save]':{click:'saveReceiver'}},insert:function(b,e){Ext.getStore('CityL').load({start:0,limit:1000,callback:function(){Ext.widget('formCustomer').down('form').loadRecord(Ext.create('susencargos.model.Customer'))}})},cleanFilters:function(b,e){b.up('grid').filters.clearFilters()},cancel:function(b,e){b.up('window').close()},changePass:function(a,c){Ext.create("Ext.window.Window",{title:"Cambiar contrase\xf1a",iconCls:"edit",alias:"widget.formChangePass",width:300,modal:true,layout:"fit",autoShow:true,items:[{xtype:"form",url:"update/user_pass.php",defaults:{labelAlign:"right"},frame:true,items:[{xtype:'panel',html:'* Campos obligatorios',border:0,padding:10},{xtype:"hiddenfield",name:"iduser",value:a.up("form").getForm().getRecord().get('user').iduser},{xtype:"textfield",name:"pass",itemId:"pass",vtype:"alphanum",value:"",allowBlank:false,inputType:"password",anchor:"90%",fieldLabel:"* Contrase\xf1a"},{xtype:"textfield",name:"confirm",value:"",allowBlank:false,vtype:"password",initialPassField:"pass",inputType:"password",anchor:"90%",fieldLabel:"* Confirmaci\xf3n"}]}],buttons:[{text:"Guardar",handler:function(b,d){if(b.up('window').down("form").getForm().isValid()){b.up('window').down("form").getForm().submit({waitMsg:"Guardando ...",success:function(e,f,h){var g=Ext.JSON.decode(f.response.responseText);Ext.MessageBox.show({title:g.msg.title,msg:g.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO});b.up("window").close()},failure:function(e,f){var g=Ext.JSON.decode(f.response.responseText);Ext.MessageBox.show({title:g.msg.title,msg:g.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});b.up("window").close()}})}else{Ext.MessageBox.show({title:"Error",msg:"Ingrese los datos correctos",buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}}},{text:"Cancelar",handler:function(b,d){b.up("window").close()}}]})},edit:function(v,r,c,i,e){Ext.getStore('CityL').load({params:{start:0,limit:1000},callback:function(){var form=Ext.widget('formCustomer');form.down('form').loadRecord(v.getStore().getAt(c));form.down('form').getForm().findField('idcity').setValue(v.getStore().getAt(c).get('city').idcity);form.down('form').getForm().findField('email').setValue(v.getStore().getAt(c).get('user').email)}})},editDbl:function(g,r){Ext.getStore('CityL').load({params:{start:0,limit:1000},callback:function(){var form=Ext.widget('formCustomer');form.down('form').loadRecord(r);form.down('form').getForm().findField('idcity').setValue(r.get('city').idcity);form.down('form').getForm().findField('email').setValue(r.get('user').email)}})},save:function(b,e){if(b.up('form').getForm().isValid()){b.up('form').getForm().findField('id').setValue(b.up('form').getForm().findField('idcustomer').getValue());b.up('form').getForm().submit({waitMsg:'Guardando ...',success:function(t,p,o){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('Customer').load();Ext.getStore('CustomerL').load({start:0,limit:1000})}});b.up('window').close()},failure:function(t,p){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});b.up('window').close()}})}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}},remove:function(v,r,c,i,e){Ext.MessageBox.confirm('Eliminar registro','¿Desea eliminar el registro?',function(o){if(o=='yes'){Ext.Ajax.request({url:'delete/delete_object.php',params:{id:v.getStore().getAt(c).get('idcustomer'),object:'customers'},success:function(response){var d=Ext.JSON.decode(response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('Customer').load()}})},failed:function(t,p,o){Ext.MessageBox.show({title:p.response.result.msg.title,msg:p.response.result.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}})}})},receivers:function(v,r,c,i,e){Ext.getStore('Receiver').getProxy().setExtraParam('idcustomer',v.getStore().getAt(c).get('idcustomer'));Ext.getStore('Receiver').load();Ext.getStore('ReceiverL').getProxy().setExtraParam('idcustomer',v.getStore().getAt(c).get('idcustomer'));var opened=false;var content=Ext.getCmp('contenido');var panel=null;Ext.each(content.items.items,function(n,i,s){if(n.alias=='widget.listReceivers'){opened=true;panel=n}});if(!opened){panel=Ext.widget('listReceivers');content.add(panel)}panel.setTitle('Listado destinatarios del cliente '+v.getStore().getAt(c).get('name'));Ext.getCmp('contenido').setActiveTab(panel)},insertReceiver:function(b,e){Ext.getStore('CityL').load({start:0,limit:10000,callback:function(){var form=Ext.widget('formReceiver');form.down('form').loadRecord(Ext.create('susencargos.model.Receiver'));form.down('form').getForm().findField('idcustomer').setValue(Ext.getStore('Receiver').getProxy().extraParams.idcustomer)}})},cleanFiltersReceivers:function(b,e){b.up('grid').filters.clearFilters()},editDblReceiver:function(g,r){Ext.getStore('CityL').load({start:0,limit:10000,callback:function(){var form=Ext.widget('formReceiver');form.down('form').getForm().loadRecord(r);form.down('form').getForm().findField('idcustomer').setValue(Ext.getStore('Receiver').getProxy().extraParams.idcustomer);form.down('form').getForm().findField('idcity').setValue(r.get('city').idcity)}})},editReceiver:function(v,r,c,i,e){Ext.getStore('CityL').load({start:0,limit:10000,callback:function(){var form=Ext.widget('formReceiver');form.down('form').getForm().loadRecord(v.getStore().getAt(c));form.down('form').getForm().findField('idcustomer').setValue(Ext.getStore('Receiver').getProxy().extraParams.idcustomer);form.down('form').getForm().findField('idcity').setValue(v.getStore().getAt(c).get('city').idcity)}})},saveReceiver:function(b,e){if(b.up('form').getForm().isValid()){b.up('form').getForm().findField('id').setValue(b.up('form').getForm().findField('idreceiver').getValue());b.up('form').getForm().submit({waitMsg:'Guardando ...',success:function(t,p,o){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('Receiver').load();Ext.getStore('ReceiverL').load()}});b.up('window').close()},failure:function(t,p){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});b.up('window').close()}})}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}},removeReceiver:function(v,c,dr,dp){Ext.MessageBox.confirm('Eliminar registro','¿Desea eliminar el registro?',function(o){if(o=='yes'){Ext.Ajax.request({url:'delete/delete_object.php',params:{id:v.getSelectionModel().getLastSelected().get('idreceiver'),object:'receivers'},success:function(response){var d=Ext.JSON.decode(response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('Receiver').load()}})},failed:function(t,p,o){Ext.MessageBox.show({title:p.response.result.msg.title,msg:p.response.result.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}})}})}});Ext.create('Ext.app.Controller',{control:{'listZones button[action=insert]':{click:'insert'},'listZones button[action=clean]':{click:'cleanFilters'},'listZones':{itemdblclick:'editDbl'},'listZones actioncolumn[action=edit]':{click:'edit'},'listZones actioncolumn[action=remove]':{click:'remove'},'formZone button[action=cancel]':{click:'cancel'},'formZone button[action=save]':{click:'save'}},insert:function(b,e){Ext.widget('formZone').down('form').loadRecord(Ext.create('susencargos.model.Zone'))},cleanFilters:function(b,e){b.up('grid').filters.clearFilters()},cancel:function(b,e){b.up('window').close()},edit:function(v,r,c,i,e){var form=Ext.widget('formZone');form.down('form').loadRecord(v.getStore().getAt(c))},editDbl:function(g,r){var form=Ext.widget('formZone');form.down('form').loadRecord(r)},save:function(b,e){if(b.up('form').getForm().isValid()){b.up('form').getForm().findField('id').setValue(b.up('form').getForm().findField('idzone').getValue());b.up('form').getForm().submit({waitMsg:'Guardando ...',success:function(t,p,o){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('Zone').load()}});b.up('window').close()},failure:function(t,p){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});b.up('window').close()}})}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}},remove:function(v,r,c,i,e){Ext.MessageBox.confirm('Eliminar registro','¿Desea eliminar el registro?',function(o){if(o=='yes'){Ext.Ajax.request({url:'delete/delete_object.php',params:{id:v.getStore().getAt(c).get('idzone'),object:'zones'},success:function(response){var d=Ext.JSON.decode(response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('Zone').load()}})},failed:function(t,p,o){Ext.MessageBox.show({title:p.response.result.msg.title,msg:p.response.result.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}})}})}});Ext.create('Ext.app.Controller',{control:{'listCities button[action=insert]':{click:'insert'},'listCities button[action=clean]':{click:'cleanFilters'},'listCities':{itemdblclick:'editDbl'},'listCities actioncolumn[action=edit]':{click:'edit'},'listCities actioncolumn[action=remove]':{click:'remove'},'formCity button[action=cancel]':{click:'cancel'},'formCity button[action=save]':{click:'save'}},insert:function(b,e){Ext.widget('formCity').down('form').loadRecord(Ext.create('susencargos.model.City'))},cleanFilters:function(b,e){b.up('grid').filters.clearFilters()},cancel:function(b,e){b.up('window').close()},edit:function(v,r,c,i,e){Ext.getStore('ZoneL').load({callback:function(){var form=Ext.widget('formCity');form.down('form').loadRecord(v.getStore().getAt(c));form.down('form').getForm().findField('idzone').setValue(v.getStore().getAt(c).get('zone').idzone)}})},editDbl:function(g,r){Ext.getStore('ZoneL').load({callback:function(){var form=Ext.widget('formCity');form.down('form').loadRecord(r);form.down('form').getForm().findField('idzone').setValue(r.get('zone').idzone)}})},save:function(b,e){if(b.up('form').getForm().isValid()){b.up('form').getForm().findField('id').setValue(b.up('form').getForm().findField('idcity').getValue());b.up('form').getForm().submit({waitMsg:'Guardando ...',success:function(t,p,o){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('City').load()}});b.up('window').close()},failure:function(t,p){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});b.up('window').close()}})}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}},remove:function(v,r,c,i,e){Ext.MessageBox.confirm('Eliminar registro','¿Desea eliminar el registro?',function(o){if(o=='yes'){Ext.Ajax.request({url:'delete/delete_object.php',params:{id:v.getStore().getAt(c).get('idcity'),object:'cities'},success:function(response){var d=Ext.JSON.decode(response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('City').load()}})},failed:function(t,p,o){Ext.MessageBox.show({title:p.response.result.msg.title,msg:p.response.result.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}})}})}});Ext.create('Ext.app.Controller',{control:{'listPackages button[action=insert]':{click:'insert'},'listPackages button[action=clean]':{click:'cleanFilters'},'listPackages':{itemdblclick:'editDbl'},'listPackages actioncolumn[action=tracking]':{click:'tracking'},'listPackages actioncolumn[action=rotules]':{click:'rotules'},'listPackages actioncolumn[action=label]':{click:'label'},'listPackages actioncolumn[action=edit]':{click:'edit'},'listPackages actioncolumn[action=remove]':{click:'remove'},'formPackage combo[name=idcustomer]':{select:'changeCustomer'},'formPackage combo[name=idreceiver]':{select:'changeReceiver'},'formPackage combo[name=idpackagetype]':{select:'changePackageType'},'formPackage numberfield[name=shippingValue]':{change:'changeShippingValue'},'formPackage numberfield[name=managementValue]':{change:'changeManagementValue'},'formPackage button[action=cancel]':{click:'cancel'},'formPackage button[action=save]':{click:'save'}},insert:function(b,e){Ext.widget('formPackage').down('form').loadRecord(Ext.create('susencargos.model.Package'))},cleanFilters:function(b,e){b.up('grid').filters.clearFilters()},cancel:function(b,e){b.up('window').close()},changeCustomer:function(c,i){if(c.getValue()!=0){var form=c.up('window').down('form').getForm();form.findField('idcitysource').setValue(Ext.getStore('CustomerL').findRecord('idcustomer',c.getValue()).get('city').idcity);Ext.getStore('Receiver').getProxy().setExtraParam('idcustomer',c.getValue());Ext.getStore('ReceiverL').getProxy().setExtraParam('idcustomer',c.getValue());Ext.getStore('ReceiverL').load({start:0,limit:100})}else{Ext.MessageBox.confirm('Crear cliente','¿Desea crear un nuevo cliente?',function(o){if(o=='yes'){Ext.getStore('CityL').load({start:0,limit:1000,callback:function(){Ext.widget('formCustomer').down('form').loadRecord(Ext.create('susencargos.model.Customer'))}})}})}},changeReceiver:function(c,i){if(c.getValue()!=0){var form=c.up('window').down('form').getForm();var receiver=Ext.getStore('ReceiverL').findRecord('idreceiver',c.getValue());form.findField('idcitydestination').setValue(receiver.get('city').idcity);form.findField('addressTo').setValue(receiver.get('address'));form.findField('phoneTo').setValue(receiver.get('phone'))}else{Ext.MessageBox.confirm('Crear destinatario','¿Desea crear un nuevo destinatario?',function(o){if(o=='yes'){Ext.getStore('CityL').load({start:0,limit:1000,callback:function(){var form=Ext.widget('formReceiver').down('form');form.loadRecord(Ext.create('susencargos.model.Receiver'));form.getForm().findField('idcustomer').setValue(Ext.getStore('ReceiverL').getProxy().extraParams.idcustomer)}})}})}},changePackageType:function(c,i){var form=c.up('window').down('form').getForm();if(c.getValue()==1){form.findField('weight').setValue(30)}else{form.findField('weight').setValue(1)}},changeShippingValue:function(f,v,o){if(v!=null){var managementValue=f.up('form').getForm().findField('managementValue').getValue();if(managementValue!=null){f.up('form').getForm().findField('totalValue').setValue(v+managementValue)}}},changeManagementValue:function(f,v,o){if(v!=null){var shippingValue=f.up('form').getForm().findField('shippingValue').getValue();if(shippingValue!=null){f.up('form').getForm().findField('totalValue').setValue(v+shippingValue)}}},tracking:function(v,r,c,i,e){Ext.getStore('Tracking').getProxy().setExtraParam('idpackage',v.getStore().getAt(c).get('idpackage'));Ext.getStore('Tracking').load({callback:function(){var opened=false;var content=Ext.getCmp('contenido');var panel=null;Ext.each(content.items.items,function(n,i,s){if(n.alias=='widget.listTrackings'){opened=true;panel=n}});if(!opened){panel=Ext.widget('listTrackings');content.add(panel)}panel.setTitle('Seguimiento de la guía '+v.getStore().getAt(c).get('idpackage'));Ext.getCmp('contenido').setActiveTab(panel)}})},rotules:function(v,r,c,i,e){window.open('rotules.php?id='+v.getStore().getAt(c).get('idpackage'))},label:function(v,r,c,i,e){window.open('label.php?id='+v.getStore().getAt(c).get('idpackage'))},edit:function(v,r,c,i,e){Ext.getStore('CityL').load({params:{start:0,limit:1000},callback:function(){Ext.getStore('CustomerL').load({params:{start:0,limit:1000},callback:function(){Ext.getStore('PayTypeL').load({callback:function(){Ext.getStore('PackageTypeL').load({callback:function(){var form=Ext.widget('formPackage');form.down('form').loadRecord(v.getStore().getAt(c));form.down('form').getForm().findField('idcitysource').setValue(v.getStore().getAt(c).get('citySource').idcity);form.down('form').getForm().findField('idcitydestination').setValue(v.getStore().getAt(c).get('cityDestination').idcity);form.down('form').getForm().findField('idcustomer').setValue(v.getStore().getAt(c).get('customer').idcustomer);form.down('form').getForm().findField('idcustomer').fireEvent('select',form.down('form').getForm().findField('idcustomer'));form.down('form').getForm().findField('idpaytype').setValue(v.getStore().getAt(c).get('payType').idpaytype);form.down('form').getForm().findField('idpackagetype').setValue(v.getStore().getAt(c).get('packageType').idpackagetype)}})}})}})}})},editDbl:function(g,r){Ext.getStore('CityL').load({params:{start:0,limit:1000},callback:function(){Ext.getStore('CustomerL').load({params:{start:0,limit:1000},callback:function(){Ext.getStore('PayTypeL').load({callback:function(){Ext.getStore('PackageTypeL').load({callback:function(){var form=Ext.widget('formCity');form.down('form').loadRecord(r);form.down('form').getForm().findField('idcitysource').setValue(r.get('citySource').idcity);form.down('form').getForm().findField('idcitydestination').setValue(r.get('cityDestination').idcity);form.down('form').getForm().findField('idcustomer').setValue(r.get('customer').idcustomer);form.down('form').getForm().findField('idcustomer').fireEvent('select',form.down('form').getForm().findField('idcustomer'));form.down('form').getForm().findField('idpaytype').setValue(r.get('payType').idpaytype);form.down('form').getForm().findField('idpackagetype').setValue(r.get('packageType').idpackagetype)}})}})}})}})},save:function(b,e){if(b.up('form').getForm().isValid()&&b.up('form').getForm().findField('idcustomer').getValue()!=0&&b.up('form').getForm().findField('idreceiver').getValue()!=0){b.up('form').getForm().findField('id').setValue(b.up('form').getForm().findField('idpackage').getValue());b.up('form').getForm().submit({waitMsg:'Guardando ...',success:function(t,p,o){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('Package').load()}});b.up('window').close()},failure:function(t,p){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});b.up('window').close()}})}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}},remove:function(v,r,c,i,e){Ext.MessageBox.confirm('Eliminar registro','¿Desea eliminar el registro?',function(o){if(o=='yes'){Ext.Ajax.request({url:'delete/delete_object.php',params:{id:v.getStore().getAt(c).get('idpackage'),object:'packages'},success:function(response){var d=Ext.JSON.decode(response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('Package').load()}})},failed:function(t,p,o){Ext.MessageBox.show({title:p.response.result.msg.title,msg:p.response.result.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}})}})}});Ext.create('Ext.app.Controller',{control:{'listPayTypes button[action=insert]':{click:'insert'},'listPayTypes button[action=clean]':{click:'cleanFilters'},'listPayTypes':{itemdblclick:'editDbl'},'listPayTypes actioncolumn[action=edit]':{click:'edit'},'listPayTypes actioncolumn[action=remove]':{click:'remove'},'formPayType button[action=cancel]':{click:'cancel'},'formPayType button[action=save]':{click:'save'}},insert:function(b,e){Ext.widget('formPayType').down('form').loadRecord(Ext.create('susencargos.model.PayType'))},cleanFilters:function(b,e){b.up('grid').filters.clearFilters()},cancel:function(b,e){b.up('window').close()},edit:function(v,r,c,i,e){var form=Ext.widget('formPayType');form.down('form').loadRecord(v.getStore().getAt(c))},editDbl:function(g,r){var form=Ext.widget('formPayType');form.down('form').loadRecord(r)},save:function(b,e){if(b.up('form').getForm().isValid()){b.up('form').getForm().findField('id').setValue(b.up('form').getForm().findField('idpaytype').getValue());b.up('form').getForm().submit({waitMsg:'Guardando ...',success:function(t,p,o){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('PayType').load()}});b.up('window').close()},failure:function(t,p){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});b.up('window').close()}})}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}},remove:function(v,r,c,i,e){Ext.MessageBox.confirm('Eliminar registro','¿Desea eliminar el registro?',function(o){if(o=='yes'){Ext.Ajax.request({url:'delete/delete_object.php',params:{id:v.getStore().getAt(c).get('idpaytype'),object:'payTypes'},success:function(response){var d=Ext.JSON.decode(response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('PayType').load()}})},failed:function(t,p,o){Ext.MessageBox.show({title:p.response.result.msg.title,msg:p.response.result.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}})}})}});Ext.create('Ext.app.Controller',{control:{'listLevelsAccess button[action=insert]':{click:'insert'},'listLevelsAccess button[action=clean]':{click:'cleanFilters'},'listLevelsAccess':{itemdblclick:'editDbl'},'listLevelsAccess actioncolumn[action=edit]':{click:'edit'},'listLevelsAccess actioncolumn[action=remove]':{click:'remove'},'formLevelAccess button[action=cancel]':{click:'cancel'},'formLevelAccess button[action=save]':{click:'save'}},insert:function(b,e){Ext.widget('formLevelAccess').down('form').loadRecord(Ext.create('susencargos.model.LevelAccess'))},cleanFilters:function(b,e){b.up('grid').filters.clearFilters()},cancel:function(b,e){b.up('window').close()},edit:function(v,r,c,i,e){var form=Ext.widget('formLevelAccess');form.down('form').loadRecord(v.getStore().getAt(c))},editDbl:function(g,r){var form=Ext.widget('formLevelAccess');form.down('form').loadRecord(r)},save:function(b,e){if(b.up('form').getForm().isValid()){b.up('form').getForm().findField('id').setValue(b.up('form').getForm().findField('idlevelaccess').getValue());b.up('form').getForm().submit({waitMsg:'Guardando ...',success:function(t,p,o){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('LevelAccess').load()}});b.up('window').close()},failure:function(t,p){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});b.up('window').close()}})}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}},remove:function(v,r,c,i,e){Ext.MessageBox.confirm('Eliminar registro','¿Desea eliminar el registro?',function(o){if(o=='yes'){Ext.Ajax.request({url:'delete/delete_object.php',params:{id:v.getStore().getAt(c).get('idlevelaccess'),object:'levelsAccess'},success:function(response){var d=Ext.JSON.decode(response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('LevelAccess').load()}})},failed:function(t,p,o){Ext.MessageBox.show({title:p.response.result.msg.title,msg:p.response.result.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}})}})}});Ext.create('Ext.app.Controller',{control:{'listPackageTypes button[action=insert]':{click:'insert'},'listPackageTypes button[action=clean]':{click:'cleanFilters'},'listPackageTypes':{itemdblclick:'editDbl'},'listPackageTypes actioncolumn[action=edit]':{click:'edit'},'listPackageTypes actioncolumn[action=remove]':{click:'remove'},'formPackageType button[action=cancel]':{click:'cancel'},'formPackageType button[action=save]':{click:'save'}},insert:function(b,e){Ext.widget('formPackageType').down('form').loadRecord(Ext.create('susencargos.model.PackageType'))},cleanFilters:function(b,e){b.up('grid').filters.clearFilters()},cancel:function(b,e){b.up('window').close()},edit:function(v,r,c,i,e){var form=Ext.widget('formPackageType');form.down('form').loadRecord(v.getStore().getAt(c))},editDbl:function(g,r){var form=Ext.widget('formPackageType');form.down('form').loadRecord(r)},save:function(b,e){if(b.up('form').getForm().isValid()){b.up('form').getForm().findField('id').setValue(b.up('form').getForm().findField('idpackagetype').getValue());b.up('form').getForm().submit({waitMsg:'Guardando ...',success:function(t,p,o){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('PackageType').load()}});b.up('window').close()},failure:function(t,p){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});b.up('window').close()}})}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}},remove:function(v,r,c,i,e){Ext.MessageBox.confirm('Eliminar registro','¿Desea eliminar el registro?',function(o){if(o=='yes'){Ext.Ajax.request({url:'delete/delete_object.php',params:{id:v.getStore().getAt(c).get('idpackagetype'),object:'PackageType'},success:function(response){var d=Ext.JSON.decode(response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){Ext.getStore('PackageType').load()}})},failed:function(t,p,o){Ext.MessageBox.show({title:p.response.result.msg.title,msg:p.response.result.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}})}})}});Ext.create('Ext.app.Controller',{control:{'formReceivePackage textfield[name=tracking]':{keypress:'addTracking'},'formReceivePackage button[action=cancel]':{click:'cancel'},'formReceivePackage button[action=save]':{click:'save'},'formReceivePackage form grid actioncolumn[action=remove]':{click:'removeTracking'}},cancel:function(b,e){Ext.getStore('AuxReceivePackage').removeAll();b.up('window').close()},save:function(b,e){if(b.up('form').getForm().isValid()){if(Ext.getStore('AuxReceivePackage').count()>0){var trackings='';var first=true;Ext.getStore('AuxReceivePackage').each(function(r){if(first){first=false}else{trackings+=","}trackings+=r.get('tracking')});b.up('form').getForm().findField('trackings').setValue(trackings);b.up('form').getForm().findField('id').setValue(0);b.up('form').getForm().submit({waitMsg:'Guardando ...',success:function(t,p,o){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO});Ext.getStore('AuxReceivePackage').removeAll();b.up('window').close()},failure:function(t,p){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({autoScroll:true,maxHeight:400,title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});b.up('window').close()}})}else{Ext.MessageBox.show({title:'Error',msg:'Debe ingresar al menos una remesa',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}},addTracking:function(t,e){if(e.getKey()===Ext.EventObject.ENTER){var auxString1=new String(t.getValue());t.setValue(auxString1.toUpperCase());if(t.getValue()!=""){var already=false;Ext.getStore('AuxReceivePackage').each(function(r){if(r.get("tracking")==t.getValue()){already=true}});if(!already){Ext.getStore('AuxReceivePackage').add({"tracking":t.getValue()})}t.setValue("");t.up('window').down('grid').getView().focusRow(Ext.getStore('AuxReceivePackage').count()-1);t.focus()}}},removeTracking:function(v,r,c,i,e){Ext.MessageBox.confirm('Eliminar registro','¿Desea eliminar el registro?',function(o){if(o=='yes'){Ext.getStore('AuxReceivePackage').remove(v.getStore().getAt(c))}})}});Ext.create('Ext.app.Controller',{control:{'formDispatchPackage textfield[name=tracking]':{keypress:'addTracking'},'formDispatchPackage button[action=cancel]':{click:'cancel'},'formDispatchPackage button[action=save]':{click:'save'},'formDispatchPackage form grid actioncolumn[action=remove]':{click:'removeTracking'}},cancel:function(b,e){Ext.getStore('AuxReceivePackage').removeAll();b.up('window').close()},save:function(b,e){if(b.up('form').getForm().isValid()){if(Ext.getStore('AuxReceivePackage').count()>0){var trackings='';var first=true;Ext.getStore('AuxReceivePackage').each(function(r){if(first){first=false}else{trackings+=","}trackings+=r.get('tracking')});b.up('form').getForm().findField('trackings').setValue(trackings);b.up('form').getForm().findField('id').setValue(0);b.up('form').getForm().submit({waitMsg:'Guardando ...',success:function(t,p,o){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO});Ext.getStore('AuxReceivePackage').removeAll();b.up('window').close()},failure:function(t,p){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({autoScroll:true,maxHeight:400,title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});b.up('window').close()}})}else{Ext.MessageBox.show({title:'Error',msg:'Debe ingresar al menos una remesa',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}},addTracking:function(t,e){if(e.getKey()===Ext.EventObject.ENTER){var auxString1=new String(t.getValue());t.setValue(auxString1.toUpperCase());if(t.getValue()!=""){var already=false;Ext.getStore('AuxReceivePackage').each(function(r){if(r.get("tracking")==t.getValue()){already=true}});if(!already){Ext.getStore('AuxReceivePackage').add({"tracking":t.getValue()})}t.setValue("");t.up('window').down('grid').getView().focusRow(Ext.getStore('AuxReceivePackage').count()-1);t.focus()}}},removeTracking:function(v,r,c,i,e){Ext.MessageBox.confirm('Eliminar registro','¿Desea eliminar el registro?',function(o){if(o=='yes'){Ext.getStore('AuxReceivePackage').remove(v.getStore().getAt(c))}})}});Ext.create('Ext.app.Controller',{control:{'formDeliveryPackage button[action=cancel]':{click:'cancel'},'formDeliveryPackage button[action=save]':{click:'save'}},cancel:function(b,e){b.up('window').close()},save:function(b,e){if(b.up('form').getForm().isValid()){b.up('form').getForm().findField('id').setValue(0);b.up('form').getForm().submit({waitMsg:'Guardando ...',success:function(t,p,o){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO});b.up('window').close()},failure:function(t,p){var d=Ext.JSON.decode(p.response.responseText);Ext.MessageBox.show({autoScroll:true,maxHeight:400,title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});b.up('window').close()}})}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}}});Ext.create('Ext.app.Controller',{control:{'formFlightManifest button[action=cancel]':{click:'cancel'},'formFlightManifest button[action=save]':{click:'save'}},cancel:function(b,e){b.up('window').close()},save:function(b,e){if(b.up('form').getForm().isValid()){Ext.Ajax.request({url:'stores/reports.php',params:{object:'flightManifest',date:Ext.Date.format(b.up('form').getForm().findField('date').getValue(),'Y-m-d')},success:function(response){var d=Ext.JSON.decode(response.responseText);Ext.MessageBox.show({title:'Reporte generado',msg:'El reporte fue generado con éxito haga clic en el botón para descargarlo',buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){window.open(d.msg.body);b.up('window').close()}})},failed:function(t,p,o){Ext.MessageBox.show({title:p.response.result.msg.title,msg:p.response.result.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}})}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}}});Ext.create('Ext.app.Controller',{control:{'formBilling button[action=cancel]':{click:'cancel'},'formBilling button[action=save]':{click:'save'}},cancel:function(b,e){b.up('window').close()},save:function(b,e){if(b.up('form').getForm().isValid()){Ext.Ajax.request({url:'stores/reports.php',params:{object:'billing',idcustomer:b.up('form').getForm().findField('idcustomer').getValue(),from:Ext.Date.format(b.up('form').getForm().findField('from').getValue(),'Y-m-d'),to:Ext.Date.format(b.up('form').getForm().findField('to').getValue(),'Y-m-d')},success:function(response){var d=Ext.JSON.decode(response.responseText);Ext.MessageBox.show({title:'Reporte generado',msg:'El reporte fue generado con éxito haga clic en el botón para descargarlo',buttons:Ext.Msg.OK,icon:Ext.Msg.INFO,fn:function(){window.open(d.msg.body);b.up('window').close()}})},failed:function(t,p,o){Ext.MessageBox.show({title:p.response.result.msg.title,msg:p.response.result.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}})}else{Ext.MessageBox.show({title:'Error',msg:'Ingrese los datos correctos',buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}}});Ext.application({requires:['Ext.container.Viewport','Ext.chart.*','Ext.ux.form.TinyMCE'],name:'susencargos',launch:function(){Ext.create('susencargos.store.MainStoreRemote',{storeId:'Application',model:'susencargos.model.Application',object:'apps'});Ext.create('susencargos.store.MainStoreLocal',{storeId:'ApplicationL',model:'susencargos.model.Application',object:'apps'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'Group',model:'susencargos.model.Group',object:'groups'});Ext.create('susencargos.store.MainStoreLocal',{storeId:'GroupL',model:'susencargos.model.Group',object:'groups'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'Module',model:'susencargos.model.Module',object:'modules'});Ext.create('susencargos.store.MainStoreLocal',{storeId:'ModuleL',model:'susencargos.model.Module',object:'modules'});Ext.create('Ext.data.TreeStore',{storeId:'ModuleTree',model:'susencargos.model.Module',nodeParam:'module',remoteSort:true,proxy:{type:'ajax',url:'stores/module_tree.php',extraParams:{idapplication:0},reader:{type:'json',root:'module',successProperty:'success'},listeners:{exception:function(p,r,o,op){var d=Ext.JSON.decode(r.responseText);Ext.MessageBox.show({title:d.msg.title,msg:d.msg.body,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}}}});Ext.create('susencargos.store.MainStoreRemote',{storeId:'User',model:'susencargos.model.User',object:'users'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'Customer',model:'susencargos.model.Customer',object:'customers'});Ext.create('susencargos.store.MainStoreLocal',{storeId:'CustomerL',model:'susencargos.model.Customer',object:'customers',listeners:{load:function(s){s.insert(0,{idcustomer:0,name:'.:: Nuevo cliente ::.',taxid:'0',address:'',phone:'',city:{idcity:0,name:''},user:{iduser:0,name:''},contact:''})}}});Ext.create('susencargos.store.MainStoreRemote',{storeId:'Zone',model:'susencargos.model.Zone',object:'zones'});Ext.create('susencargos.store.MainStoreLocal',{storeId:'ZoneL',model:'susencargos.model.Zone',object:'zones'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'City',model:'susencargos.model.City',object:'cities'});Ext.create('susencargos.store.MainStoreLocal',{storeId:'CityL',model:'susencargos.model.City',object:'cities'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'GroupsUser',model:'susencargos.model.Group',object:'groupsUser'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'NoGroupsUser',model:'susencargos.model.Group',object:'noGroupsUser'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'NoUsersGroup',model:'susencargos.model.User',object:'noUsersGroup'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'UsersGroup',model:'susencargos.model.User',object:'usersGroup'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'StateTracking',model:'susencargos.model.StateTracking',object:'statesTracking'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'Package',model:'susencargos.model.Package',object:'packages'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'PayType',model:'susencargos.model.PayType',object:'payTypes'});Ext.create('susencargos.store.MainStoreLocal',{storeId:'PayTypeL',model:'susencargos.model.PayType',object:'payTypes'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'PackageType',model:'susencargos.model.PackageType',object:'packageTypes'});Ext.create('susencargos.store.MainStoreLocal',{storeId:'PackageTypeL',model:'susencargos.model.PackageType',object:'packageTypes'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'ApplicationsGroup',model:'susencargos.model.Application',object:'applicationsGroup'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'GroupsApplication',model:'susencargos.model.Group',object:'groupsApplication'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'NoApplicationsGroup',model:'susencargos.model.Application',object:'noApplicationsGroup'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'NoGroupsApplication',model:'susencargos.model.Group',object:'noGroupsApplication'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'LevelAccess',model:'susencargos.model.LevelAccess',object:'levelsAccess'});Ext.create('susencargos.store.MainStoreLocal',{storeId:'LevelAccessL',model:'susencargos.model.LevelAccess',object:'levelsAccess'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'GroupsModule',model:'susencargos.model.GroupModule',object:'groupsModule'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'Tracking',model:'susencargos.model.Tracking',object:'trackings'});Ext.create('Ext.data.Store',{storeId:'AuxReceivePackage',model:'susencargos.model.AuxReceivePackage',remoteSort:true});Ext.create('susencargos.store.MainStoreRemote',{storeId:'TemplateMail',model:'susencargos.model.TemplateMail',object:'templatesMail'});Ext.create('susencargos.store.MainStoreRemote',{storeId:'Receiver',model:'susencargos.model.Receiver',object:'receivers'});Ext.create('susencargos.store.MainStoreLocal',{storeId:'ReceiverL',model:'susencargos.model.Receiver',object:'receivers',listeners:{load:function(s){s.insert(0,{idreceiver:0,name:'.:: Nuevo destinatario ::.',address:'',phone:'',city:{idcity:0,name:''},customer:{idcustomer:0,name:''}})}}});Ext.define('susencargos.view.MainGrid',{extend:'Ext.grid.Panel',alias:'',plugins:{ptype:'gridfilters',menuFilterText:'Filtros'},layout:'fit',closable:true,autoScroll:true,buttonsAds:[],buttonsIni:['-',{xtype:'button',text:'Insertar',iconCls:'insert',tooltip:'Insertar',action:'insert'},'-',{xtype:'button',icon:'css/clean.png',text:'Limpiar filtros',tooltip:'Limpiar filtros',action:'clean'}],bbar:{xtype:'pagingtoolbar',pageSize:25,displayInfo:true,items:[]},viewConfig:{enableTextSelection:true},constructor:function(config){this.bbar.store=this.store;this.bbar.items=this.buttonsIni.concat(this.buttonsAds);this.callParent(config)}});Ext.define('susencargos.view.MainForm',{extend:'Ext.window.Window',iconCls:'edit',width:600,maximizable:true,object:'',fields:[],buttons:[],modal:true,layout:'fit',autoShow:true,items:[{xtype:'form',autoScroll:true,url:'update/save_object.php',defaults:{labelAlign:'right'}}],initComponent:function(){this.items[0].items=[{xtype:'hiddenfield',name:'id',value:''},{xtype:'hiddenfield',name:'object',value:this.object},{xtype:'panel',html:'* Campos obligatorios',border:0,padding:10}].concat(this.fields);this.items[0].buttons=this.buttons;this.buttons=null;this.callParent()}});Ext.define('susencargos.view.MainItemSelector',{extend:'Ext.window.Window',maximizable:true,modal:true,width:Ext.getBody().getViewSize().width*0.8,height:500,autoShow:true,layout:{type:'hbox',align:'stretch',padding:5},defaults:{flex:1},columns:[],storeSource:'',storeFinish:'',items:[{xtype:'grid',title:'No asignados',id:'gridSource',multiSelect:true,plugins:{ptype:'gridfilters',menuFilterText:'Filtros'},bbar:{xtype:'pagingtoolbar',pageSize:25,displayInfo:true},viewConfig:{plugins:{ptype:'gridviewdragdrop',dragGroup:'source',dropGroup:'destination'}}},{xtype:'grid',id:'gridDestination',multiSelect:true,title:'Asignados',plugins:{ptype:'gridfilters',menuFilterText:'Filtros'},store:'GroupsUser',bbar:{xtype:'pagingtoolbar',pageSize:25,displayInfo:true},viewConfig:{plugins:{ptype:'gridviewdragdrop',dragGroup:'destination',dropGroup:'source'}}}],constructor:function(config){this.items[0].columns=this.columns;this.items[0].store=this.storeSource;this.items[0].bbar.store=this.storeSource;this.items[1].columns=this.columns;this.items[1].store=this.storeFinish;this.items[1].bbar.store=this.storeFinish;this.callParent(config)}});Ext.define('susencargos.view.application.Grid',{extend:'susencargos.view.MainGrid',iconCls:'apps',alias:'widget.listApplications',title:'Listado aplicaciones',store:'Application',columns:[{header:'ID',filter:'number',dataIndex:'idapplication'},{header:'Nombre',filter:'string',dataIndex:'name',flex:3},{xtype:'actioncolumn',width:20,action:'groups',tooltip:'Grupos',icon:'css/group.png',stopSelection:false,iconCls:'group'},{xtype:'actioncolumn',width:20,action:'modules',tooltip:'M\xf3dulos',icon:'css/module.png',stopSelection:false,iconCls:'module'},{xtype:'actioncolumn',width:20,action:'edit',tooltip:'Editar',icon:'css/edit.png',stopSelection:false,iconCls:'edit'},{xtype:'actioncolumn',width:20,action:'remove',tooltip:'Eliminar',stopSelection:false,icon:'css/remove.png',iconCls:'remove'}]});Ext.define('susencargos.view.application.Form',{extend:'susencargos.view.MainForm',alias:'widget.formApplication',title:'Editar aplicaci\xf3n',object:'apps',fields:[{xtype:'hiddenfield',name:'idapplication',value:0},{xtype:'textfield',name:'name',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Nombre'}],buttons:[{text:'Guardar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.define('susencargos.view.application.Groups',{extend:'susencargos.view.MainItemSelector',alias:'widget.listGroupsApplication',title:'Listado grupos de la aplicaci\xf3n',iconCls:'group',columns:[{header:'ID',filter:'number',dataIndex:'idgroup'},{header:'Nombre',filter:'string',dataIndex:'name',flex:3},{header:'Activo',dataIndex:'active',filter:'boolean',renderer:function(value){if(value){return"Si"}else{return"No"}},flex:1}],storeSource:'NoGroupsApplication',storeFinish:'GroupsApplication'});Ext.define('susencargos.view.application.FormGroupModule',{extend:'susencargos.view.MainForm',alias:'widget.formGroupModule',title:'Editar grupo de un m\xf3dulo',object:'groupsModule',fields:[{xtype:'hiddenfield',name:'idgroupmodule',value:0},{xtype:'hiddenfield',name:'idmodule',value:0},{xtype:'combo',name:'idgroup',value:'',store:'GroupL',valueField:'idgroup',displayField:'name',allowBlank:false,autoLoadOnValue:true,fieldLabel:'* Grupo',queryMode:'local',anchor:'90%',typeAhead:true,forceSelection:true},{xtype:'combo',name:'idlevelaccess',value:'',store:'LevelAccessL',valueField:'idlevelaccess',autoLoadOnValue:true,displayField:'name',allowBlank:false,fieldLabel:'* Nivel de acceso',queryMode:'local',anchor:'90%',typeAhead:true,forceSelection:true}],buttons:[{text:'Guardar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.define('susencargos.view.application.GroupsModule',{extend:'susencargos.view.MainGrid',iconCls:'group',alias:'widget.listGroupsModule',title:'Listado grupos asignados a un m\xf3dulo',store:'GroupsModule',columns:[{header:'ID',filter:'number',dataIndex:'idgroupmodule'},{header:'Grupo',dataIndex:'group',renderer:function(v){return v.name},flex:3},{header:'Nivel de acceso',dataIndex:'levelAccess',renderer:function(v){return v.name},flex:3},{xtype:'actioncolumn',width:20,action:'edit',tooltip:'Editar',icon:'css/edit.png',stopSelection:false,iconCls:'edit'},{xtype:'actioncolumn',width:20,action:'remove',tooltip:'Eliminar',stopSelection:false,icon:'css/remove.png',iconCls:'remove'}]});Ext.define('susencargos.view.group.Grid',{extend:'susencargos.view.MainGrid',iconCls:'group',alias:'widget.listGroups',title:'Listado grupos',store:'Group',columns:[{header:'ID',filter:'number',dataIndex:'idgroup'},{header:'Nombre',filter:'string',dataIndex:'name',flex:3},{header:'Activo',dataIndex:'active',filter:'boolean',renderer:function(value){if(value){return"Si"}else{return"No"}},flex:1},{xtype:'actioncolumn',width:20,action:'applications',tooltip:'Aplicaciones',icon:'css/apps.png',stopSelection:false,iconCls:'apps'},{xtype:'actioncolumn',width:20,action:'users',tooltip:'Usuarios',icon:'css/user.png',stopSelection:false,iconCls:'user'},{xtype:'actioncolumn',width:20,action:'edit',tooltip:'Editar',icon:'css/edit.png',stopSelection:false,iconCls:'edit'},{xtype:'actioncolumn',width:20,action:'remove',tooltip:'Eliminar',icon:'css/remove.png',stopSelection:false,iconCls:'remove'}]});Ext.define('susencargos.view.group.Form',{extend:'susencargos.view.MainForm',alias:'widget.formGroup',title:'Editar grupo',object:'groups',fields:[{xtype:'hiddenfield',name:'idgroup',value:0},{xtype:'textfield',name:'name',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Nombre'},{xtype:'combo',name:'active',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Activo',autoLoadOnValue:true,store:[[false,'No'],[true,'Si']],queryMode:'local',forceSelection:true,typeAHead:true}],buttons:[{text:'Guardar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.define('susencargos.view.group.Users',{extend:'susencargos.view.MainItemSelector',iconCls:'user',alias:'widget.listUsersGroup',columns:[{header:'ID',filter:'number',dataIndex:'iduser'},{header:'Login',filter:'string',dataIndex:'login',flex:3},{header:'Nombre',filter:'string',dataIndex:'name',flex:3},{header:'Activo',dataIndex:'active',filter:'boolean',renderer:function(value){if(value){return"Si"}else{return"No"}},flex:1}],storeSource:'NoUsersGroup',storeFinish:'UsersGroup'});Ext.define('susencargos.view.group.Applications',{extend:'susencargos.view.MainItemSelector',alias:'widget.listApplicationsGroup',title:'Listado aplicaciones del grupo',iconCls:'apps',columns:[{header:'ID',dataIndex:'idapplication'},{header:'Nombre',dataIndex:'name',flex:3}],storeSource:'NoApplicationsGroup',storeFinish:'ApplicationsGroup'});Ext.define('susencargos.view.application.Modules',{extend:'Ext.tree.Panel',iconCls:'module',plugins:{ptype:'gridfilters',menuFilterText:'Filtros'},alias:'widget.listModules',title:'Listado m\xf3dulos',layout:'fit',store:'ModuleTree',closable:true,displayField:'name',rootVisible:false,useArrows:true,autoScroll:true,columns:[{header:'Nombre',xtype:'treecolumn',filter:'string',dataIndex:'name',flex:3},{header:'Clase',filter:'string',dataIndex:'class',flex:2},{header:'Script/Acci\xf3n',filter:'string',dataIndex:'script',flex:3},{xtype:'actioncolumn',width:20,action:'groups',tooltip:'Grupos',icon:'css/group.png',stopSelection:false,iconCls:'group'},{xtype:'actioncolumn',width:20,action:'edit',tooltip:'Editar',icon:'css/edit.png',stopSelection:false,iconCls:'edit'},{xtype:'actioncolumn',width:20,action:'remove',tooltip:'Eliminar',stopSelection:false,icon:'css/remove.png',iconCls:'remove'}],bbar:{xtype:'toolbar',items:[{xtype:'button',text:'Insertar',iconCls:'insert',tooltip:'Insertar',action:'insert'},'-',{xtype:'button',icon:'css/clean.png',text:'Limpiar filtros',tooltip:'Limpiar filtros',action:'clean'}]}});Ext.define('susencargos.view.application.FormModule',{extend:'susencargos.view.MainForm',alias:'widget.formModule',title:'Editar m\xf3dulo',object:'modules',fields:[{xtype:'hiddenfield',name:'idmodule',value:0},{xtype:'combo',name:'idparent',emptyText:'- Nuevo m\xf3dulo -',value:'',anchor:'90%',store:'ModuleL',valueField:'idmodule',autoLoadOnValue:true,displayField:'name',fieldLabel:'* M\xf3dulo padre',queryMode:'local',forceSelection:true,typeAhead:true},{xtype:'hiddenfield',name:'idapplication',value:0},{xtype:'textfield',name:'name',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Nombre'},{xtype:'textfield',name:'class',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Clase'},{xtype:'textfield',name:'script',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Script/Acci\xf3n'}],buttons:[{text:'Guardar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.define('susencargos.view.user.Grid',{extend:'susencargos.view.MainGrid',alias:'widget.listUsers',title:'Listado usuarios',store:'User',iconCls:'user',columns:[{header:'ID',filter:'number',dataIndex:'iduser'},{header:'Login',filter:'string',dataIndex:'login',flex:3},{header:'Nombre',filter:'string',dataIndex:'name',flex:3},{header:'Activo',dataIndex:'active',filter:'boolean',renderer:function(value){if(value){return"Si"}else{return"No"}},flex:1},{header:'Ultimo ingreso',dataIndex:'lastLogin',filter:{type:'date',fields:{lt:{text:'Antes de'},gt:{text:'Depu\xe9s de '},eq:{text:'El d\xeda'}},dateFormat:'Y-m-d H:i:s'},flex:1,renderer:Ext.util.Format.dateRenderer('Y-m-d H:i:s')},{header:'Logeado',dataIndex:'logged',filter:'boolean',renderer:function(value){if(value){return"Si"}else{return"No"}},flex:1},{header:'Email',filter:'string',dataIndex:'email',flex:3},{xtype:'actioncolumn',width:20,action:'group',tooltip:'Grupos',icon:'css/group.png',stopSelection:false,iconCls:'group'},{xtype:'actioncolumn',width:20,action:'edit',tooltip:'Editar',icon:'css/edit.png',stopSelection:false,iconCls:'edit'},{xtype:'actioncolumn',width:20,action:'remove',tooltip:'Eliminar',icon:'css/remove.png',iconCls:'remove',stopSelection:false}]});Ext.define('susencargos.view.user.Form',{extend:'susencargos.view.MainForm',alias:'widget.formUser',title:'Editar usuario',object:'users',fields:[{xtype:'hiddenfield',name:'iduser',value:0},{xtype:'textfield',name:'login',vtype:"email",value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Login'},{xtype:'textfield',name:'name',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Nombre'},{xtype:'combo',name:'active',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Activo',autoLoadOnValue:true,store:[[false,'No'],[true,'Si']],forceSelection:true,queryMode:'local',typeAHead:true},{xtype:'textfield',name:'email',value:'',vtype:'email',allowBlank:false,anchor:'90%',fieldLabel:'* Email'}],buttons:[{text:'Cambiar contrase\xf1a',action:'changePass'},{text:'Guardar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.define('susencargos.view.user.Groups',{extend:'susencargos.view.MainItemSelector',alias:'widget.listGroupsUser',iconCls:'group',storeSource:'NoGroupsUser',storeFinish:'GroupsUser',columns:[{header:'ID',dataIndex:'idgroup'},{header:'Nombre',dataIndex:'name',flex:3},{header:'Activo',dataIndex:'active',renderer:function(value){if(value){return"Si"}else{return"No"}},flex:1}]});Ext.define('susencargos.view.customer.Grid',{extend:'susencargos.view.MainGrid',iconCls:'customer',alias:'widget.listCustomers',title:'Listado clientes',store:'Customer',columns:[{header:'ID',filter:'number',dataIndex:'idcustomer'},{header:'Nombre',filter:'string',dataIndex:'name',flex:3},{header:'NIT',filter:'string',dataIndex:'taxid',flex:2},{header:'Dirección',filter:'string',dataIndex:'address',flex:3},{header:'Teléfono',filter:'string',dataIndex:'phone',flex:2},{header:'Ciudad',dataIndex:'city',flex:2,renderer:function(value){return value.name}},{header:'Email',dataIndex:'user',flex:2,renderer:function(value){return value.email}},{xtype:'actioncolumn',width:20,action:'receivers',tooltip:'Destinatarios',icon:'css/receiver.png',stopSelection:false,iconCls:'receiver'},{xtype:'actioncolumn',width:20,action:'edit',tooltip:'Editar',icon:'css/edit.png',stopSelection:false,iconCls:'edit'},{xtype:'actioncolumn',width:20,action:'remove',tooltip:'Eliminar',icon:'css/remove.png',stopSelection:false,iconCls:'remove'}]});Ext.define('susencargos.view.customer.Form',{extend:'susencargos.view.MainForm',alias:'widget.formCustomer',title:'Editar cliente',object:'customers',fields:[{xtype:'hiddenfield',name:'idcustomer',value:0},{xtype:'textfield',name:'name',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Nombre'},{xtype:'textfield',name:'taxid',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* NIT'},{xtype:'textfield',name:'address',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Dirección'},{xtype:'textfield',name:'phone',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Teléfono'},{xtype:'combo',fieldLabel:'Ciudad',store:'CityL',typeAhead:true,forceSelection:true,allowBlank:false,autoLoadOnValue:true,valueField:'idcity',displayField:'name',name:'idcity',anchor:'90%',queryMode:'local'},{xtype:'textfield',name:'email',vtype:'email',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Email'},{xtype:'textfield',name:'contact',value:'',anchor:'90%',fieldLabel:'Contacto'}],buttons:[{text:'Cambiar contrase\xf1a',action:'changePass'},{text:'Guardar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.define('susencargos.view.customer.GridReceivers',{extend:'susencargos.view.MainGrid',iconCls:'receiver',alias:'widget.listReceivers',title:'Listado destinatarios',store:'Receiver',columns:[{header:'ID',filter:'number',dataIndex:'idreceiver'},{header:'Nombre',filter:'string',dataIndex:'name',flex:3},{header:'Dirección',filter:'string',dataIndex:'address',flex:3},{header:'Teléfono',filter:'string',dataIndex:'phone',flex:2},{header:'Ciudad',dataIndex:'city',flex:2,renderer:function(value){return value.name}},{xtype:'actioncolumn',width:20,action:'edit',tooltip:'Editar',icon:'css/edit.png',stopSelection:false,iconCls:'edit'},{xtype:'actioncolumn',width:20,action:'remove',tooltip:'Eliminar',icon:'css/remove.png',stopSelection:false,iconCls:'remove'}]});Ext.define('susencargos.view.customer.FormReceiver',{extend:'susencargos.view.MainForm',alias:'widget.formReceiver',title:'Editar destinatario',object:'receivers',fields:[{xtype:'hiddenfield',name:'idreceiver',value:0},{xtype:'hiddenfield',name:'idcustomer',value:0},{xtype:'textfield',name:'name',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Nombre'},{xtype:'textfield',name:'address',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Dirección'},{xtype:'textfield',name:'phone',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Teléfono'},{xtype:'combo',fieldLabel:'Ciudad',store:'CityL',typeAhead:true,forceSelection:true,allowBlank:false,autoLoadOnValue:true,valueField:'idcity',displayField:'name',name:'idcity',anchor:'90%',queryMode:'local'}],buttons:[{text:'Guardar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.define('susencargos.view.zone.Grid',{extend:'susencargos.view.MainGrid',iconCls:'zone',alias:'widget.listZones',title:'Listado rutas',store:'Zone',columns:[{header:'ID',filter:'number',dataIndex:'idzone'},{header:'Nombre',filter:'string',dataIndex:'name',flex:3},{xtype:'actioncolumn',width:20,action:'edit',tooltip:'Editar',icon:'css/edit.png',stopSelection:false,iconCls:'edit'},{xtype:'actioncolumn',width:20,action:'remove',tooltip:'Eliminar',icon:'css/remove.png',stopSelection:false,iconCls:'remove'}]});Ext.define('susencargos.view.zone.Form',{extend:'susencargos.view.MainForm',alias:'widget.formZone',title:'Editar ruta',object:'zones',fields:[{xtype:'hiddenfield',name:'idzone',value:0},{xtype:'textfield',name:'name',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Nombre'}],buttons:[{text:'Guardar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.define('susencargos.view.city.Grid',{extend:'susencargos.view.MainGrid',iconCls:'city',alias:'widget.listCities',title:'Listado ciudades',store:'City',columns:[{header:'ID',filter:'number',dataIndex:'idcity'},{header:'Nombre',filter:'string',dataIndex:'name',flex:3},{header:'Zona',dataIndex:'zone',flex:2,renderer:function(value){return value.name}},{xtype:'actioncolumn',width:20,action:'edit',tooltip:'Editar',icon:'css/edit.png',stopSelection:false,iconCls:'edit'},{xtype:'actioncolumn',width:20,action:'remove',tooltip:'Eliminar',icon:'css/remove.png',stopSelection:false,iconCls:'remove'}]});Ext.define('susencargos.view.city.Form',{extend:'susencargos.view.MainForm',alias:'widget.formCity',title:'Editar ciudad',object:'cities',fields:[{xtype:'hiddenfield',name:'idcity',value:0},{xtype:'textfield',name:'name',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Nombre'},{xtype:'combo',fieldLabel:'Ruta',store:'ZoneL',typeAhead:true,forceSelection:true,allowBlank:false,valueField:'idzone',autoLoadOnValue:true,displayField:'name',name:'idzone',anchor:'90%',queryMode:'local'}],buttons:[{text:'Guardar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.define('susencargos.view.state_tracking.Grid',{extend:'susencargos.view.MainGrid',iconCls:'stateTracking',alias:'widget.listStatesTracking',title:'Listado estados de remesa',store:'StateTracking',columns:[{header:'ID',filter:'number',dataIndex:'idstatetracking'},{header:'Nombre',filter:'string',dataIndex:'name',flex:3},{xtype:'actioncolumn',width:20,action:'edit',tooltip:'Editar',icon:'css/edit.png',stopSelection:false,iconCls:'edit'},{xtype:'actioncolumn',width:20,action:'remove',tooltip:'Eliminar',stopSelection:false,icon:'css/remove.png',iconCls:'remove'}]});Ext.define('susencargos.view.state_tracking.Form',{extend:'susencargos.view.MainForm',alias:'widget.formStateTracking',title:'Editar estado de remesa',object:'statesTracking',fields:[{xtype:'hiddenfield',name:'idstatetracking',value:0},{xtype:'textfield',name:'name',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Nombre'}],buttons:[{text:'Guardar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.define('susencargos.view.package.Grid',{extend:'susencargos.view.MainGrid',iconCls:'package',alias:'widget.listPackages',title:'Listado remesas',store:'Package',columns:[{header:'ID',filter:'number',dataIndex:'idpackage',flex:1},{header:'Fecha',dataIndex:'date',filter:{type:'date',fields:{lt:{text:'Antes de'},gt:{text:'Depu\xe9s de '},eq:{text:'El d\xeda'}},dateFormat:'Y-m-d'},flex:2,renderer:Ext.util.Format.dateRenderer('Y-m-d')},{header:'Cliente',dataIndex:'customer',flex:2,renderer:function(value){return value.name}},{header:'Origen',dataIndex:'citySource',flex:2,renderer:function(value){return value.name}},{header:'Destino',dataIndex:'cityDestination',flex:2,renderer:function(value){return value.name}},{header:'Destinatario',dataIndex:'nameTo',flex:2},{header:'Dirección',dataIndex:'addressTo',flex:2},{header:'Peso',dataIndex:'weight',flex:1},{header:'Cantidad',dataIndex:'amount',flex:1},{header:'Valor declarado',dataIndex:'declaredValue',flex:1},{header:'Tipo de pago',dataIndex:'payType',flex:2,renderer:function(value){return value.name}},{xtype:'actioncolumn',width:20,action:'tracking',tooltip:'Seguimiento',icon:'css/tracking.png',stopSelection:false,iconCls:'rotule'},{xtype:'actioncolumn',width:20,action:'rotules',tooltip:'Imprimir rótulos',icon:'css/rotule.png',stopSelection:false,iconCls:'rotule'},{xtype:'actioncolumn',width:20,action:'label',tooltip:'Imprimir remesa',icon:'css/label.png',stopSelection:false,iconCls:'label'},{xtype:'actioncolumn',width:20,action:'edit',tooltip:'Editar',icon:'css/edit.png',stopSelection:false,iconCls:'edit'},{xtype:'actioncolumn',width:20,action:'remove',tooltip:'Eliminar',stopSelection:false,icon:'css/remove.png',iconCls:'remove'}]});Ext.define('susencargos.view.package.Form',{extend:'susencargos.view.MainForm',alias:'widget.formPackage',title:'Editar remesa',object:'packages',fields:[{xtype:'container',layout:{type:'table',columns:2},defaults:{layout:'anchor',anchor:'100%',style:"margin: 3px; padding:3px;"},items:[{xtype:'hiddenfield',name:'idpackage',value:0},{xtype:'combo',fieldLabel:'* Remitente',store:'CustomerL',typeAhead:true,forceSelection:true,allowBlank:false,valueField:'idcustomer',displayField:'name',autoLoadOnValue:true,name:'idcustomer',anchor:'90%',queryMode:'local'},{xtype:'datefield',name:'date',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Fecha del envío',format:'Y-m-d'},{xtype:'combo',fieldLabel:'* Tipo de pago',autoLoadOnValue:true,store:'PayTypeL',typeAhead:true,forceSelection:true,allowBlank:false,valueField:'idpaytype',displayField:'name',name:'idpaytype',anchor:'90%',queryMode:'local'},{xtype:'combo',fieldLabel:'* Tipo de envío',store:'PackageTypeL',autoLoadOnValue:true,typeAhead:true,forceSelection:true,allowBlank:false,valueField:'idpackagetype',displayField:'name',name:'idpackagetype',anchor:'90%',queryMode:'local'},{xtype:'combo',fieldLabel:'* Ciudad origen',autoLoadOnValue:true,store:'CityL',typeAhead:true,forceSelection:true,allowBlank:false,valueField:'idcity',displayField:'name',name:'idcitysource',anchor:'90%',queryMode:'local'},{xtype:'combo',fieldLabel:'* Destinatario',store:'ReceiverL',typeAhead:true,forceSelection:true,allowBlank:false,valueField:'idreceiver',displayField:'name',autoLoadOnValue:true,name:'idreceiver',anchor:'90%',queryMode:'local'},{xtype:'combo',fieldLabel:'* Ciudad destino',autoLoadOnValue:true,store:'CityL',typeAhead:true,forceSelection:true,allowBlank:false,valueField:'idcity',displayField:'name',name:'idcitydestination',anchor:'90%',queryMode:'local'},{xtype:'textfield',name:'addressTo',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Dirección destinatario'},{xtype:'textfield',name:'phoneTo',value:'',anchor:'90%',fieldLabel:'Teléfono destinatario'},{xtype:'textfield',name:'content',value:'',anchor:'90%',fieldLabel:'Dice contener'},{xtype:'textfield',name:'observations',value:'',anchor:'90%',fieldLabel:'Observaciones'},{xtype:'numberfield',hideTrigger:true,name:'weight',value:0,anchor:'90%',fieldLabel:'Peso'},{xtype:'numberfield',hideTrigger:true,name:'volumen',value:0,anchor:'90%',fieldLabel:'Volumen'},{xtype:'numberfield',hideTrigger:true,name:'amount',allowBlank:false,value:1,anchor:'90%',fieldLabel:'* Cantidad'},{xtype:'numberfield',hideTrigger:true,name:'declaredValue',allowBlank:false,value:400000,anchor:'90%',fieldLabel:'* Valor declarado'},{xtype:'numberfield',hideTrigger:true,name:'shippingValue',value:0,anchor:'90%',fieldLabel:'Valor del flete'},{xtype:'numberfield',hideTrigger:true,name:'managementValue',value:0,anchor:'90%',fieldLabel:'Valor manejo'},{xtype:'numberfield',hideTrigger:true,name:'totalValue',value:30,readOnly:true,anchor:'90%',fieldLabel:'Valor total'},{xtype:'textfield',name:'reference',value:'',anchor:'90%',fieldLabel:'Referencia'}]}],buttons:[{text:'Guardar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.define('susencargos.view.package.Tracking',{extend:'susencargos.view.MainGrid',iconCls:'tracking',alias:'widget.listTrackings',title:'Seguimiento',store:'Tracking',columns:[{header:'ID',filter:'number',dataIndex:'idtracking',flex:1},{header:'Fecha',dataIndex:'date',filter:{type:'date',fields:{lt:{text:'Antes de'},gt:{text:'Depu\xe9s de '},eq:{text:'El d\xeda'}},dateFormat:'Y-m-d H:i:s'},flex:2,renderer:Ext.util.Format.dateRenderer('Y-m-d H:i:s')},{header:'Estado',dataIndex:'state',flex:2,renderer:function(value){return value.name}}]});Ext.define('susencargos.view.payType.Grid',{extend:'susencargos.view.MainGrid',iconCls:'payType',alias:'widget.listPayTypes',title:'Listado de tipos de pago',store:'PayType',columns:[{header:'ID',filter:'number',dataIndex:'idpaytype'},{header:'Nombre',filter:'string',dataIndex:'name',flex:3},{xtype:'actioncolumn',width:20,action:'edit',tooltip:'Editar',icon:'css/edit.png',stopSelection:false,iconCls:'edit'},{xtype:'actioncolumn',width:20,action:'remove',tooltip:'Eliminar',icon:'css/remove.png',stopSelection:false,iconCls:'remove'}]});Ext.define('susencargos.view.payType.Form',{extend:'susencargos.view.MainForm',alias:'widget.formPayType',title:'Editar tipo de pago',object:'payTypes',fields:[{xtype:'hiddenfield',name:'idpaytype',value:0},{xtype:'textfield',name:'name',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Nombre'}],buttons:[{text:'Guardar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.define('susencargos.view.levelAccess.Grid',{extend:'susencargos.view.MainGrid',iconCls:'levelAccess',alias:'widget.listLevelsAccess',title:'Listado de niveles de acceso',store:'LevelAccess',columns:[{header:'ID',filter:'number',dataIndex:'idlevelaccess'},{header:'Nombre',filter:'string',dataIndex:'name',flex:3},{xtype:'actioncolumn',width:20,action:'edit',tooltip:'Editar',icon:'css/edit.png',stopSelection:false,iconCls:'edit'},{xtype:'actioncolumn',width:20,action:'remove',tooltip:'Eliminar',icon:'css/remove.png',stopSelection:false,iconCls:'remove'}]});Ext.define('susencargos.view.levelAccess.Form',{extend:'susencargos.view.MainForm',alias:'widget.formLevelAccess',title:'Editar nivel de acceso',object:'levelsAccess',fields:[{xtype:'hiddenfield',name:'idlevelaccess',value:0},{xtype:'textfield',name:'name',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Nombre'}],buttons:[{text:'Guardar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.define('susencargos.view.packageType.Grid',{extend:'susencargos.view.MainGrid',iconCls:'packageType',alias:'widget.listPackageTypes',title:'Listado de tipos de envío',store:'PackageType',columns:[{header:'ID',filter:'number',dataIndex:'idpackagetype'},{header:'Nombre',filter:'string',dataIndex:'name',flex:3},{xtype:'actioncolumn',width:20,action:'edit',tooltip:'Editar',icon:'css/edit.png',stopSelection:false,iconCls:'edit'},{xtype:'actioncolumn',width:20,action:'remove',tooltip:'Eliminar',icon:'css/remove.png',stopSelection:false,iconCls:'remove'}]});Ext.define('susencargos.view.packageType.Form',{extend:'susencargos.view.MainForm',alias:'widget.formPackageType',title:'Editar tipo de envío',object:'packageTypes',fields:[{xtype:'hiddenfield',name:'idpackagetype',value:0},{xtype:'textfield',name:'name',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Nombre'}],buttons:[{text:'Guardar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.define('susencargos.view.receive_package.Form',{extend:'susencargos.view.MainForm',alias:'widget.formReceivePackage',title:'Recepcionar paquetes en bodega',object:'receivePackages',fields:[{xtype:'hiddenfield',name:'trackings',value:''},{xtype:'textfield',fieldLabel:'* No. Remesa',labelWidth:200,name:'tracking',anchor:'95%',enableKeyEvents:true,value:''},{xtype:'grid',height:300,anchor:'100%',store:'AuxReceivePackage',layout:'fit',columns:[{xtype:'rownumberer'},{header:'No. remesa',flex:1,dataIndex:'tracking'},{xtype:'actioncolumn',width:20,action:'remove',tooltip:'Eliminar',icon:'css/remove.png',stopSelection:false,iconCls:'remove'}]}],buttons:[{text:'Guardar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.define('susencargos.view.dispatch_package.Form',{extend:'susencargos.view.MainForm',alias:'widget.formDispatchPackage',title:'Recepcionar paquetes en bodega',object:'dispatchPackages',fields:[{xtype:'hiddenfield',name:'trackings',value:''},{xtype:'textfield',fieldLabel:'* No. Remesa',labelWidth:200,name:'tracking',anchor:'95%',enableKeyEvents:true,value:''},{xtype:'grid',height:300,anchor:'100%',store:'AuxReceivePackage',layout:'fit',columns:[{xtype:'rownumberer'},{header:'No. remesa',flex:1,dataIndex:'tracking'},{xtype:'actioncolumn',width:20,action:'remove',tooltip:'Eliminar',icon:'css/remove.png',stopSelection:false,iconCls:'remove'}]}],buttons:[{text:'Guardar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.define('susencargos.view.delivery_package.Form',{extend:'susencargos.view.MainForm',alias:'widget.formDeliveryPackage',title:'Entregar paquete a destinatario',object:'deliveryPackage',fields:[{xtype:'textfield',fieldLabel:'* No. Remesa',labelWidth:200,name:'tracking',allowBlank:false,anchor:'95%',value:''},{xtype:'filefield',fieldLabel:'Prueba de entrega',labelWidth:200,name:'pod',accept:'image/*',anchor:'95%',value:''}],buttons:[{text:'Guardar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.define('susencargos.view.templateMail.Grid',{extend:'susencargos.view.MainGrid',iconCls:'template',alias:'widget.listTemplatesMail',title:'Listado de plantillas de correo',store:'TemplateMail',columns:[{header:'ID',filter:'number',dataIndex:'idtemplatemail'},{header:'Nombre',filter:'string',dataIndex:'name',flex:1},{header:'Contenido',dataIndex:'html',flex:3},{xtype:'actioncolumn',width:20,action:'edit',tooltip:'Editar',icon:'css/edit.png',iconCls:'edit',stopSelection:false},{xtype:'actioncolumn',width:20,action:'remove',tooltip:'Eliminar',icon:'css/remove.png',iconCls:'remove',stopSelection:false}]});Ext.define('susencargos.view.templateMail.Form',{extend:'susencargos.view.MainForm',alias:'widget.formTemplateMail',title:'Editar plantilla de correo',object:'templatesMail',width:800,height:600,fields:[{xtype:'hiddenfield',name:'idtemplatemail',value:0},{xtype:'textfield',name:'name',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Nombre'},{xtype:"tinymce",fieldLabel:'* Contenido',name:'html',id:'tinymce_f',anchor:'90%',height:350}],buttons:[{text:'Guardar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.define('susencargos.view.flightManifest.Form',{extend:'susencargos.view.MainForm',alias:'widget.formFlightManifest',title:'Seleccionar fecha de planilla de vuelo',fields:[{xtype:'datefield',name:'date',value:'',allowBlank:false,anchor:'90%',fieldLabel:'* Fecha del envío',format:'Y-m-d'}],buttons:[{text:'Generar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.define('susencargos.view.flightManifest.Form',{extend:'susencargos.view.MainForm',alias:'widget.formBilling',title:'Seleccionar cliente',fields:[{xtype:'combo',fieldLabel:'* Cliente',store:'CustomerL',typeAhead:true,forceSelection:true,allowBlank:false,valueField:'idcustomer',displayField:'name',autoLoadOnValue:true,name:'idcustomer',anchor:'90%',queryMode:'local'},{xtype:'datefield',name:'from',anchor:'95%',itemId:'startdt',vtype:'daterange',endDateField:'enddt',altFormats:'Y-m-d',format:'Y-m-d',submitFormat:'Y-m-d',allowBlank:false,fieldLabel:'* Fecha inicio'},{xtype:'datefield',name:'to',itemId:'enddt',anchor:'95%',vtype:'daterange',startDateField:'startdt',altFormats:'Y-m-d',format:'Y-m-d',submitFormat:'Y-m-d',allowBlank:false,fieldLabel:'* Fecha fin'}],buttons:[{text:'Generar',action:'save'},{text:'Cancelar',action:'cancel'}]});Ext.create('Ext.container.Viewport',{layout:'border',items:[{tbar:{defaults:{scale:'medium'},loader:{url:'menu.php',renderer:'component',autoLoad:true}},region:'center',autoScroll:true,id:'contenido',tabPosition:'bottom',xtype:'tabpanel',activeTab:0,items:[{xtype:'panel',title:'Bienvenidos',loader:{autoLoad:true,url:'home.php'}}]},{region:'south',xtype:'panel',html:'<b>Susencargos.com.co &copy;</b>'}]})}});